{"version":3,"sources":["components/Actions/Actions.module.css","components/Status.module.css","components/CapStoryChart.module.css","components/EffectValue.module.css","components/Header.module.css","components/Content.module.css","components/Round/Round.module.css","lib/random.ts","lib/byProp.ts","lib/version.ts","lib/persistState.ts","lib/restartGame.ts","constants.ts","config/rounds/images/example.jpg","config/rounds/index.ts","config/rounds/round1.tsx","config/rounds/round2.tsx","config/rounds/round3.tsx","config/rounds/round4.tsx","config/rounds/round5.tsx","config/gremlins/gremlins.tsx","config/gameEffects/gameEffects.ts","state/effects/helpers.ts","state/rounds/getRoundEffects.ts","state/gameActions/gameActions.ts","state/gameActions/findGameActionById.ts","state/gameActions/getAvailableGameActions.ts","state/gameActions/getEffects.ts","state/gremlins.ts","state/game.ts","state/round.ts","state/gameActions/getCost.ts","lib/storySucceeds.ts","state/useAppState.ts","components/CapStoryChart.tsx","components/Button.tsx","components/FinalResults.tsx","components/Round/Round.tsx","components/Round/Results.tsx","components/EffectValue.tsx","components/Round/Description.tsx","components/Round/Welcome.tsx","components/Actions/Overlay.tsx","components/Actions/ActionImage.tsx","state/gameActions/types.ts","components/Actions/Action.tsx","components/Actions/RoundActions.tsx","components/Actions/Actions.tsx","components/Status.tsx","components/Header.tsx","components/Rules.tsx","components/Content.tsx","components/Container.tsx","components/Log.tsx","components/Tabs.tsx","components/Rows.tsx","App.tsx","index.tsx","components/Log.module.css","components/Tabs.module.css","components/Button.module.css","components/Container.module.css","components/Rows.module.css"],"names":["module","exports","random","Math","sumByProp","objects","key","sum","forEach","obj","concatByProp","all","push","hashCode","string","hash","length","toString","replace","i","charCodeAt","Promise","resolve","reject","a","fetch","response","text","LOCAL_STATE_KEY","GAME_STATE_OUTDATED","Symbol","GAME_STATE_OK","getSearchParams","Object","fromEntries","window","location","search","split","map","entry","parts","decodeURIComponent","localStateData","localStorage","getItem","restoreData","restore","data","JSON","parse","atob","versionP","version","state","restored","Date","parseInt","from","status","console","warn","INITIAL_STATE","localState","useVersion","useState","setVersion","useEffect","canceled","then","v","catch","err","saveToLocalStorage","setItem","stringify","restartGame","dispatch","confirm","type","EFFECT_HIDDEN","TOTAL_INTERACTIVE_ROUNDS","GAME_ROUNDS","rounds","1","title","description","effect","capacityChange","userStoryChange","gremlinChange","actions","PROTECTED_FROM_OUTSIDE_DISTRACTION","image","name","href","cost","CLARIFY_PRODUCT_VISION","WORKING_AGREEMENTS","example","BUILD_SERVER","TEAMS_ON_SAME_FLOOR","age","this","2","REMOTE_TEAM_AVATARS","icon","ELIMINATE_LONG_LIVED_FEATURE_BRANCHES","UNIT_TESTING","available","requires","SOCIAL_TIME","PROBLEM_SOLVING_BONUS","change","BACKLOG_REFINEMENT","3","OBSERVE_PEOPLE_AND_RELATIONSHIPS","ONE_ON_ONES","PAIR_PROGRAMMING","STORY_MAPPING_OR_OTHER","REFACTORING","4","CROSS_SKILLING","EXTERNAL_CROSS_TRAINING","NEW_TESTER","resultDesc","BA_QA_DEV_COLLABORATION","TEST_DRIVEN_DEVELOPMENT","PERSONAL_PRODUCTIVITY_BONUS","5","gremlins","GREMLIN_MANAGEMENT_YELLS","probability","finishedActionIds","includes","GREMLIN_EMERGENCY_ON_OTHER_TEAM","capacity","GREMLIN_NOT_PULLING_THEIR_WEIGHT","GREMLIN_NOT_AT_DAILY_SCRUM","gameEffects","technicalDebtDrag","roundsWithoutEngAction","selectedGameActionIds","findGameActionById","find","communicationDebtDrag","roundsWithoutCommunicationAction","isEffect","e","isVisibleEffect","getRoundEffects","currentRound","pastRounds","roundEffects","desc","previousRounds","slice","Array","isArray","nextRoundEffect","nextRoundGremlinEffects","filter","undefined","concat","gameActions","entries","reduce","memo","roundNumber","round","actionId","action","id","gameActionId","gameAction","Error","UNIQUE","getAvailableGameActions","allDependencies","req","getDependencies","unmetDependencies","dependencies","missing","times","unique","getEffects","fallbackTitle","isGremlinId","thing","getGremlinEffects","gremlin","ui","review","view","log","getAllEffects","effects","roundAmounts","getActionEffects","values","gameEffect","getCapacity","nextRound","payload","closedRound","gameReducer","SIMULATED_TRAILING_ROUNDS","nextState","closeRound","getCosts","storiesAttempted","chance","storiesCompleted","storySucceeds","orZero","num","deriveAppRound","roundCapacity","visibleEffects","totalUserStoryChance","capacityAvailable","currentRoundNumber","selectedGameActions","currentRoundTitle","currentRoundDescription","getGremlin","gremlinEffect","visibleGremlinEffects","number","total","gremlinChance","userStoryChance","activeEffects","useAppState","initialState","useReducer","gameState","usePersistState","link","encodeURIComponent","btoa","getTime","useStateLink","availableGameActions","gremlinArray","pastGremlinIds","newGremlinsWithProbability","currentProbability","totalProbability","roll","shift","Infinity","rollGremlin","USC","SA","SC","TC","CapStoryChart","useMemo","maxUserStoryChance","max","ceil","_","userStorySteps","className","styles","chart","height","width","margin","top","right","left","bottom","strokeDasharray","dataKey","yAxisId","orientation","unit","ticks","fill","barSize","stroke","Button","primary","rest","cx","button","Results","props","onClick","style","value","readOnly","ev","target","select","Round","welcome","results","userStoryEffects","userStoryChanceList","userStoryIcons","center","disabled","Sign","String","EffectValue","RoundDescription","children","gremlinEffects","Welcome","Overlay","referenceElement","onClose","overlayRef","useRef","popperElement","setPopperElement","handler","contains","addEventListener","removeEventListener","current","arrowElement","setArrowElement","popper","usePopper","placement","modifiers","options","offset","fallbackPlacements","element","data-popper-placement","ref","overlay","attributes","arrow","overlayInner","closeOverlay","overlayTitle","ActionImage","getOwnPropertyNames","actionImage","backgroundImage","actionIcon","Action","buttonElement","setButtonElement","clickTimer","availableCapacity","clearTimeout","setTimeout","onOpen","onDoubleClick","onSelect","missingDep","actionSelected","actionFinished","isOpen","requiresTitle","requiresList","dep","RoundActions","initialVisible","visible","setVisible","roundVisibleToggle","roundActionList","actionsWithStatus","actionWithStatus","openGameActionId","open","selected","Actions","openActionId","setOpenActionId","roundList","ActiveEffects","types","negative","showUnit","cap","negativeValue","Status","percentOnUserStories","userStoryStatus","capacityEffects","capThisRound","sign","userStoryWarning","userStoryCritical","Header","header","Rules","Content","content","Container","reviewHint","Log","roundsLog","actionList","Tabs","tabs","Tab","active","tab","tabActive","Rows","rows","Row","row","App","setTab","maxWidth","display","OutdatedStateWarning","setInitialState","textAlign","toLocaleString","getInitialState","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.619aa43f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"roundList\":\"Actions_roundList__1eXTE\",\"roundVisibleToggle\":\"Actions_roundVisibleToggle__1R4cj\",\"roundActionList\":\"Actions_roundActionList__3KY_i\",\"action\":\"Actions_action__2Me2d\",\"disabled\":\"Actions_disabled__1_qfh\",\"missingDep\":\"Actions_missingDep__6ylGs\",\"actionImage\":\"Actions_actionImage__BHeO6\",\"actionIcon\":\"Actions_actionIcon__3AhOt\",\"actionSelected\":\"Actions_actionSelected__1b36j\",\"actionFinished\":\"Actions_actionFinished__3CZlA\",\"arrow\":\"Actions_arrow__QUeg2\",\"overlay\":\"Actions_overlay__1oAsV\",\"overlayInner\":\"Actions_overlayInner__chZ-k\",\"closeOverlay\":\"Actions_closeOverlay___0tEl\",\"overlayTitle\":\"Actions_overlayTitle__2w_bm\",\"requiresTitle\":\"Actions_requiresTitle__2wHur\",\"requiresList\":\"Actions_requiresList__3Ax-b\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cap\":\"Status_cap__gr-F0\",\"sign\":\"Status_sign__2-nEE\",\"status\":\"Status_status__1LWe8\",\"title\":\"Status_title__d3A6m\",\"capThisRound\":\"Status_capThisRound__Pelkl\",\"userStoryWarning\":\"Status_userStoryWarning__1BBoS\",\"userStoryCritical\":\"Status_userStoryCritical__-kvV5\",\"negative\":\"Status_negative__3Qwiy\",\"negativeValue\":\"Status_negativeValue__hgaBD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chart\":\"CapStoryChart_chart__3fmBX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"value\":\"EffectValue_value__2jCJi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__3mObx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"Content_content__mFJ5h\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"number\":\"Round_number__1Y07O\",\"title\":\"Round_title__3q6Dt\",\"description\":\"Round_description__3UaD3\",\"center\":\"Round_center__3VEdA\",\"userStoryIcons\":\"Round_userStoryIcons__3dSH1\",\"userStoryDescription\":\"Round_userStoryDescription__3t-8F\",\"userStoryChanceList\":\"Round_userStoryChanceList__RRkIa\",\"gremlinEffects\":\"Round_gremlinEffects__1WyG6\"};","export function random() {\n  return Math.random();\n}\n","type NonUndefined<A> = A extends undefined ? never : A;\ntype NumberKeys<T extends object> = {\n  [K in keyof T]-?: NonUndefined<T[K]> extends number ? K : never;\n}[keyof T];\ntype ArrayKeys<T extends object> = {\n  [K in keyof T]-?: NonUndefined<T[K]> extends any[] ? K : never;\n}[keyof T];\n\nexport function sumByProp<T extends object>(\n  objects: T[],\n  key: NumberKeys<T>,\n): number {\n  let sum = 0;\n  objects.forEach((obj) => {\n    sum += (obj as any)[key] || 0;\n  });\n  return sum;\n}\n\nexport function concatByProp<T extends object, K extends ArrayKeys<T>>(\n  objects: T[],\n  key: K,\n): T[K] {\n  const all: any = [];\n  objects.forEach((obj) => {\n    all.push(...obj[key]);\n  });\n  return all;\n}\n","/* https://stackoverflow.com/a/8831937 */\nfunction hashCode(string: string) {\n  var hash = 0;\n  if (string.length === 0) {\n    return hash.toString(36).replace(/^-/, '');\n  }\n  for (var i = 0; i < string.length; i++) {\n    var char = string.charCodeAt(i);\n    hash = (hash << 5) - hash + char;\n    hash = hash & hash;\n  }\n  return hash.toString(36).replace(/^-/, '');\n}\n\nexport default new Promise<string>(async (resolve, reject) => {\n  if (process.env.NODE_ENV === 'test') {\n    resolve('test');\n    return;\n  }\n  try {\n    const response = await fetch('/asset-manifest.json');\n    resolve(hashCode(await response.text()));\n  } catch (err) {\n    reject(err);\n  }\n});\n","import { useEffect, useState } from 'react';\nimport { INITIAL_STATE } from 'state';\nimport { GameState } from 'state/game';\nimport versionP from './version';\n\nconst LOCAL_STATE_KEY = 'TEAM_GAME_STATE';\nexport const GAME_STATE_OUTDATED = Symbol('GAME_STATE_OUTDATED');\nexport const GAME_STATE_OK = Symbol('GAME_STATE_OK');\nexport type InitialStateWithStatus = {\n  state: GameState;\n  restored?: Date;\n  status: typeof GAME_STATE_OUTDATED | typeof GAME_STATE_OK;\n};\n\nfunction getSearchParams() {\n  return Object.fromEntries(\n    window.location.search\n      .replace(/^\\?/, '')\n      .split('&')\n      .map((entry) => {\n        const parts = entry.split('=');\n        return [decodeURIComponent(parts[0]), decodeURIComponent(parts[1])];\n      }),\n  );\n}\n\nexport async function getInitialState(): Promise<InitialStateWithStatus> {\n  const localStateData = localStorage.getItem(LOCAL_STATE_KEY);\n  const search = getSearchParams();\n  const restoreData: string | undefined = search.restore;\n\n  if (restoreData) {\n    try {\n      const data = JSON.parse(atob(restoreData));\n      const version = await versionP;\n      return {\n        state: data,\n        restored: new Date(parseInt(search.from, 10)),\n        status:\n          search.version !== version ? GAME_STATE_OUTDATED : GAME_STATE_OK,\n      };\n    } catch (err) {\n      console.warn(err);\n    }\n  }\n\n  if (localStateData === null) {\n    return { state: INITIAL_STATE, status: GAME_STATE_OK };\n  }\n\n  try {\n    const localState = JSON.parse(localStateData);\n    const version = await versionP;\n    return {\n      state: localState.state,\n      status:\n        localState.version !== version ? GAME_STATE_OUTDATED : GAME_STATE_OK,\n    };\n  } catch (err) {\n    console.warn(err);\n    return { state: INITIAL_STATE, status: GAME_STATE_OK };\n  }\n}\n\nexport function useVersion() {\n  const [version, setVersion] = useState<string | null>(\n    process.env.NODE_ENV === 'test' ? 'test' : null,\n  );\n  useEffect(() => {\n    if (process.env.NODE_ENV === 'test') {\n      return;\n    }\n\n    let canceled = false;\n    versionP\n      .then((v) => {\n        if (canceled) {\n          return;\n        }\n        setVersion(v);\n      })\n      .catch((err) => {\n        if (canceled) {\n          return;\n        }\n        console.warn(err);\n      });\n\n    return () => {\n      canceled = true;\n    };\n  }, []);\n\n  return version;\n}\n\nexport function useStateLink(state: GameState) {\n  const version = useVersion();\n\n  return `${window.location.href}?restore=${encodeURIComponent(\n    btoa(JSON.stringify(state)),\n  )}${\n    version ? `&version=${encodeURIComponent(version)}` : ''\n  }&from=${encodeURIComponent(new Date().getTime())}`;\n}\n\nexport function saveToLocalStorage(state: GameState, version: string) {\n  localStorage.setItem(LOCAL_STATE_KEY, JSON.stringify({ version, state }));\n}\n\nexport function usePersistState(state: GameState) {\n  const version = useVersion();\n  useEffect(() => {\n    if (version) {\n      saveToLocalStorage(state, version);\n    }\n  }, [state, version]);\n}\n","import { GameDispatch } from '../state';\n\nexport function restartGame(dispatch: GameDispatch) {\n  return () => {\n    if (\n      window.confirm(\n        'Do you really want to start a new Game? You can not come back to this one afterwards.',\n      )\n    ) {\n      dispatch({ type: 'RESTART_GAME' });\n    }\n  };\n}\n","export const START_CAPACITY = 10;\nexport const START_USER_STORY_CHANCE = 30;\nexport const START_GREMLIN_CHANCE = 0;\nexport const GAME_ROUNDS = 8;\nexport const INTERACTIVE_TRAILING_ROUNDS = 3;\nexport const SIMULATED_TRAILING_ROUNDS = 3;\nexport const EFFECT_HIDDEN = Symbol('EFFECT_HIDDEN');\n\nexport const TOTAL_INTERACTIVE_ROUNDS =\n  GAME_ROUNDS + INTERACTIVE_TRAILING_ROUNDS;\nexport const TOTAL_ROUNDS =\n  TOTAL_INTERACTIVE_ROUNDS + SIMULATED_TRAILING_ROUNDS;\n","export default \"data:image/jpeg;base64,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\"","import type { RoundDescription } from '../../state/rounds/types';\nimport { round1, Round1ActionId } from './round1';\nimport { round2, Round2ActionId } from './round2';\nimport { round3, Round3ActionId } from './round3';\nimport { round4, Round4ActionId } from './round4';\nimport { round5, Round5ActionId } from './round5';\n\nexport type GameActionId =\n  | Round1ActionId\n  | Round2ActionId\n  | Round3ActionId\n  | Round4ActionId\n  | Round5ActionId;\n\nexport const rounds: { [key: string]: RoundDescription<string> } = {\n  1: round1,\n  2: round2,\n  3: round3,\n  4: round4,\n  5: round5,\n};\n","import React from 'react';\nimport type { RoundDescription } from '../../state';\nimport {\n  EFFECT_HIDDEN,\n  START_CAPACITY,\n  START_GREMLIN_CHANCE,\n  START_USER_STORY_CHANCE,\n} from '../../constants';\nimport example from './images/example.jpg';\n\nexport type Round1ActionId =\n  | 'PROTECTED_FROM_OUTSIDE_DISTRACTION'\n  | 'CLARIFY_PRODUCT_VISION'\n  | 'WORKING_AGREEMENTS'\n  | 'BUILD_SERVER'\n  | 'TEAMS_ON_SAME_FLOOR';\n\nexport const round1: RoundDescription<Round1ActionId> = {\n  title: 'Team, welcome to the Worlds Smallest Online Bookstore',\n  description: (\n    <p>\n      We hired you because youre the best individuals in your respective areas.\n      Please remember that were Vulture Capital funded and we have only a few\n      months runway, so you must deliver. This first Sprint, the company really\n      needs you to prove that you can deliver a working Bookstore soon.\n    </p>\n  ),\n  effect: () => ({\n    title: EFFECT_HIDDEN,\n    capacityChange: START_CAPACITY,\n    userStoryChange: START_USER_STORY_CHANCE,\n    gremlinChange: START_GREMLIN_CHANCE,\n  }),\n  actions: {\n    PROTECTED_FROM_OUTSIDE_DISTRACTION: {\n      image: 'https://placekitten.com/100/100',\n      name: 'Protected from Outside Distraction',\n      description: (\n        <p>\n          ScrumMaster protects the team from outside distraction. Example: a\n          manager asking a team member to do them a small favour as it will only\n          take an hour. For more see:{' '}\n          <a href=\"https://agilepainrelief.com/blog/scrum-master-tales-more-interruptions.html\">\n            Scrum By Example  Interruptions Hurt the Team\n          </a>{' '}\n          and{' '}\n          <a href=\"https://agilepainrelief.com/glossary/interruptions\">\n            Interruptions in the reference library\n          </a>\n        </p>\n      ),\n      cost: 1,\n      effect: () => ({ userStoryChange: 10 }),\n    },\n    CLARIFY_PRODUCT_VISION: {\n      image: 'https://placekitten.com/100/100',\n      name: 'Clarify Product Vision',\n      description: (\n        <p>\n          Product Owner and Development Team collaborate on understanding\n          Product Vision using an exercise like Product Box. Teams that arent\n          involved in the creation of their product vision are doomed to build\n          Product that neither Product Owner, Customers, nor Stakeholders want.\n        </p>\n      ),\n      cost: 2,\n      effect: () => ({ userStoryChange: 10 }),\n    },\n\n    WORKING_AGREEMENTS: {\n      image: example,\n      type: 'COMMUNICATION',\n      name: 'Working Agreements',\n      description: (\n        <p>\n          Working Agreements are a simple, powerful way of creating explicit\n          guidelines for what kind of work culture you want for your Team. They\n          are a reminder for everyone about how they can commit to respectful\n          behaviour and communication.\n        </p>\n      ),\n      cost: 1,\n      effect: () => ({ capacityChange: 1 }),\n    },\n    BUILD_SERVER: {\n      image: example,\n      type: 'ENGINEERING',\n      name: 'Build Server',\n      description: (\n        <p>\n          Setup Build Server and Continuous Integration. This is required to\n          make future engineering improvements.\n        </p>\n      ),\n      cost: 2,\n    },\n    TEAMS_ON_SAME_FLOOR: {\n      image: example,\n      name: 'Team Members on Same Floor',\n      type: 'COMMUNICATION',\n      description:\n        \"Getting Team Members on the same floor reduces the cost of communication as they don't have to go far to ask questions.\",\n      cost: 3,\n      /* don't use arrow function in order to have \"this\" bound to action */\n      effect(age) {\n        if (age < 6) {\n          return {\n            capacityChange: age,\n            title: `${this.name} active since ${age + 1} rounds`,\n          };\n        }\n\n        return {\n          capacityChange: 5,\n          title: `${this.name} active since 5 or more rounds`,\n        };\n      },\n    },\n  },\n};\n","import React from 'react';\nimport type { RoundDescription } from '../../state';\nimport example from './images/example.jpg';\n\nexport type Round2ActionId =\n  | 'REMOTE_TEAM_AVATARS'\n  | 'ELIMINATE_LONG_LIVED_FEATURE_BRANCHES'\n  | 'UNIT_TESTING'\n  | 'SOCIAL_TIME'\n  | 'PROBLEM_SOLVING_BONUS'\n  | 'BACKLOG_REFINEMENT';\n\nexport const round2: RoundDescription<Round2ActionId> = {\n  title: 'Failed Expectations',\n  description: (\n    <p>\n      Your team didn't meet our expectations that you would complete 10 User\n      Stories in the last round. Our vulture capitalists are becoming concerned\n      and ask if you can really deliver? They have decided we need more problem\n      solvers on the team.\n    </p>\n  ),\n  actions: {\n    REMOTE_TEAM_AVATARS: {\n      icon: '',\n      name: 'Remote Team Avatars',\n      description: (\n        <p>\n          Remote Teams suffer from the start, in that team members don't get to\n          know about their colleagues easily. To counter this, run a short get\n          to know you session. Get team members to share things like: working\n          hours, city they live in, time zone, contact info. If people are open,\n          share some personal details such as hobbies, family status, favorite\n          food and beverage. Some teams even create a wiki or site to share this\n          information.\n        </p>\n      ),\n      cost: 1,\n      effect: () => ({ capacityChange: 1 }),\n    },\n    ELIMINATE_LONG_LIVED_FEATURE_BRANCHES: {\n      image: example,\n      type: 'ENGINEERING',\n      name: 'All Work is Done on Main or Trunk',\n      description: (\n        <p>\n          When teams use Feature Branches  then theyre not really using\n          Continuous Integration. Feature branching optimizes for the individual\n          while harming the Team.\n        </p>\n      ),\n      cost: 2,\n      effect: () => ({ capacityChange: 1 }),\n    },\n    UNIT_TESTING: {\n      icon: '',\n      type: 'ENGINEERING',\n      name: 'Unit Testing',\n      available: { requires: 'BUILD_SERVER' },\n      description: (\n        <p>\n          Unit Testing is the approach of testing the smallest possible fragment\n          of code. It ensures that the code does what the developer expected it\n          do.\n        </p>\n      ),\n      cost: 2,\n      effect: () => ({ capacityChange: 1 }),\n    },\n    SOCIAL_TIME: {\n      image: example,\n      type: 'COMMUNICATION',\n      name: 'Social Time',\n      description: (\n        <p>\n          Setting aside some time during the working day to talk to your peers\n          outside of the work itself.\n        </p>\n      ),\n      cost: 1,\n      effect: () => ({\n        capacityChange: 1,\n        title:\n          'This benefits the team, as team members get to know each other not just as doers of work.',\n      }),\n    },\n    PROBLEM_SOLVING_BONUS: {\n      image: example,\n      name: 'Problem Solving Award',\n      description: (\n        <p>\n          Offer a bonus to the team member who solves our current site\n          performance problem.\n        </p>\n      ),\n      cost: 0,\n      effect(age) {\n        // First round it has a positive affect, the second round eliminates it. No effect after that.\n        let change = 0;\n        if (age === 1) {\n          change = 1;\n        }\n\n        return {\n          capacityChange: change,\n          title: `${this.name} active since ${age} rounds`,\n        };\n      },\n    },\n    BACKLOG_REFINEMENT: {\n      image: example,\n      type: 'COMMUNICATION',\n      name: 'Backlog Refinement',\n      description: (\n        <p>\n          The Development Team and the Product Owner sit down every Sprint. They\n          take the time to better understand upcoming features. They might\n          estimate or split stories, create acceptance criteria. They also\n          create new stories and delete ones that no longer make sense. All of\n          this improves their understanding of the product they're building.\n        </p>\n      ),\n      cost: 3,\n      effect: () => ({ userStoryChange: 15 }),\n    },\n  },\n};\n","import React from 'react';\nimport { EFFECT_HIDDEN } from '../../constants';\nimport type { RoundDescription } from '../../state';\nimport example from './images/example.jpg';\n\nexport type Round3ActionId =\n  | 'OBSERVE_PEOPLE_AND_RELATIONSHIPS'\n  | 'ONE_ON_ONES'\n  | 'PAIR_PROGRAMMING'\n  | 'STORY_MAPPING_OR_OTHER'\n  | 'REFACTORING';\n\nexport const round3: RoundDescription<Round3ActionId> = {\n  title: 'Work Harder',\n  description: (\n    <p>\n      Things are slowly improving. You are getting better. *Please* work harder\n      in the next Sprint.\n    </p>\n  ),\n  effect: () => ({ title: EFFECT_HIDDEN, gremlinChange: 50 }),\n  actions: {\n    OBSERVE_PEOPLE_AND_RELATIONSHIPS: {\n      image: example,\n      type: 'COMMUNICATION',\n      name: 'Observe People + Relationships',\n      description: (\n        <p>\n          ScrumMaster spends time observing people, how they interact, and the\n          quality of their relationship.\n        </p>\n      ),\n      cost: 1,\n      effect: () => ({\n        capacityChange: 1,\n        title: 'Watching the Team tells you where to put your coaching energy.',\n      }),\n    },\n    ONE_ON_ONES: {\n      image: example,\n      type: 'COMMUNICATION',\n      name: 'One on One',\n      description: (\n        <p>\n          ScrumMaster meets with all team members for a regular one-on-one. Once\n          Gremlins start to popup, this action mitigates the worst of the\n          effects, because you already have a deeper understanding of team\n          member needs.\n        </p>\n      ),\n      cost: 1,\n    },\n    PAIR_PROGRAMMING: {\n      image: example,\n      type: 'ENGINEERING',\n      name: 'Pair Programming',\n      description: <p>Two team members  one computer</p>,\n      cost: 2,\n      effect: () => ({\n        capacityChange: 1,\n        title:\n          'Team Members working in pairs have a lower defect rate, simpler code and learn from each other.',\n      }),\n    },\n    STORY_MAPPING_OR_OTHER: {\n      image: example,\n      type: 'COMMUNICATION',\n      name: 'Story Mapping',\n      available: { requires: 'CLARIFY_PRODUCT_VISION' },\n      description: (\n        <p>\n          Story Mapping is a strategic tool that gets Developers and the Product\n          Owner to discuss strategy. Story mapping helps link understanding of\n          Product Vision with the individual User Stories.\n        </p>\n      ),\n      cost: 2,\n      effect: () => ({ userStoryChange: 10 }),\n    },\n    REFACTORING: {\n      image: example,\n      type: 'ENGINEERING',\n      name: 'Refactoring',\n      available: { requires: 'BUILD_SERVER' },\n      description: (\n        <p>\n          Refactoring is the process of restructuring existing code without\n          changing its external behavior. It is intended to improve the design\n          and structure, while preserving its functionality. As a side effect,\n          it can reduces the volume of code and its complexity.\n        </p>\n      ),\n      cost: 1,\n      effect: () => ({\n        capacityChange: 1,\n        title:\n          'Refactoring leaves us with simplier code, allowing the team to work faster',\n      }),\n    },\n  },\n};\n","import React from 'react';\nimport type { RoundDescription } from '../../state';\nimport example from './images/example.jpg';\n\nexport type Round4ActionId =\n  | 'CROSS_SKILLING'\n  | 'EXTERNAL_CROSS_TRAINING'\n  | 'PERSONAL_PRODUCTIVITY_BONUS'\n  | 'NEW_TESTER'\n  | 'TEST_DRIVEN_DEVELOPMENT'\n  | 'BA_QA_DEV_COLLABORATION';\n\nexport const round4: RoundDescription<Round4ActionId> = {\n  title: 'Team is Bottlenecked',\n  description: (\n    <p>\n      The team is suffering, their work is queueing up in front the tester.\n      Imploring them to work faster is failing.\n    </p>\n  ),\n  actions: {\n    CROSS_SKILLING: {\n      image: example,\n      name: 'Informal Cross-Skilling',\n      description: (\n        <p>\n          Informal cross-skilling for existing team members in an area the team\n          is weak. This is often achieved through Pair Programming, Learning\n          Time, etc (Testing anyone?)\n        </p>\n      ),\n      cost: 4,\n      effect(age) {\n        let change = age - 1;\n        if (age > 4) {\n          change = 3;\n        }\n        return {\n          capacityChange: change,\n        };\n      },\n    },\n    EXTERNAL_CROSS_TRAINING: {\n      image: example,\n      name: 'Send Team Members on a Testing Course',\n      description: (\n        <p>\n          Take an outside course to improve the skills of one existing team\n          members in an area the team is weak. (Testing anyone?)\n        </p>\n      ),\n      cost: 3,\n      effect(age) {\n        let change = 0;\n        if (age > 2) {\n          change = 2;\n        }\n\n        return {\n          capacityChange: change,\n        };\n      },\n    },\n    NEW_TESTER: {\n      image: example,\n      name: 'Hiring a new Tester',\n      description: (\n        <p>\n          Hire a new Tester for the team. This person will reduce the load on\n          your existing tester and speed things up eventually.'\n        </p>\n      ),\n      cost: 2,\n      effect(age) {\n        if (age <= 2) {\n          return {\n            title:\n              'Hiring a new person and bringing them up to speed slows the team down and damages existing Team member relationships',\n            capacityChange: -age,\n          };\n        }\n        if (age === 3) {\n          return {\n            title: 'Eventually the new person starts fit in',\n            capacityChange: -1,\n          };\n        }\n        let resultDesc = 'Finally the new person helps';\n        if (age === 4) {\n          return {\n            title: resultDesc,\n            capacityChange: 1,\n          };\n        }\n        return {\n          title: resultDesc,\n          capacityChange: 2,\n        };\n      },\n    },\n    BA_QA_DEV_COLLABORATION: {\n      image: example,\n      name: 'BA, Development, Testing Collaboration',\n      description: <p>Work with team members to collaborate</p>,\n      cost: 2,\n      effect(age) {\n        let userStoryImprovement = 15;\n        if (age <= 2) {\n          return {\n            title:\n              'Improving Collaboration slows the team at first. Even from the start it improves quality and completition of User Stories',\n            capacityChange: -1,\n            userStoryChange: userStoryImprovement,\n          };\n        }\n        if (age === 3) {\n          return {\n            capacityChange: 0,\n            userStoryChange: userStoryImprovement,\n          };\n        }\n        return {\n          capacityChange: 1,\n          userStoryChange: userStoryImprovement,\n        };\n      },\n    },\n    TEST_DRIVEN_DEVELOPMENT: {\n      image: example,\n      type: 'ENGINEERING',\n      name: 'Test Driven Development',\n      available: { requires: 'REFACTORING' },\n      description: (\n        <p>\n          Writing Unit-level Tests before writing the code. TDD helps the\n          quality by ensuring the developer understands what they're attempting\n          to build before they build it. As a side effect, it reduces the volume\n          of code and its complexity, thereby reducing the number of defects.\n          This skill takes time to learn.\n        </p>\n      ),\n      cost: 3,\n      effect(age) {\n        let change = age - 1;\n        if (age > 4) {\n          change = 3;\n        }\n\n        return {\n          capacityChange: change,\n        };\n      },\n    },\n    PERSONAL_PRODUCTIVITY_BONUS: {\n      image: example,\n      name: 'Personal Productivity Bonus',\n      description: (\n        <p>\n          The company will offer anyone who exceeds their performance goals an\n          extra $5,000. A manager says team members working harder will increase\n          the likelihood of completing features on time\n        </p>\n      ),\n      cost: 2,\n      effect(age) {\n        if (age === 0) {\n          return [\n            {\n              userStoryChange: 50,\n              title:\n                'Productivity Bonus helped in the short term - team members focused on individual productivity',\n            },\n          ];\n        }\n        if (age >= 2) {\n          return [\n            {\n              capacityChange: -1,\n              title:\n                'Productivity Bonus helped in the short term and then the benefit waned. Along the way it harmed collaboration',\n            },\n          ];\n        }\n        return null;\n      },\n    },\n  },\n};\n","import React from 'react';\nimport type { RoundDescription } from '../../state';\n\nexport type Round5ActionId = never;\n\nexport const round5: RoundDescription<Round5ActionId> = {\n  title: \"We're Live and We Have Real Customers\",\n  description: (\n    <p>\n      Congratulations, our product is live in the market. People are using it\n      and they're finding bugs. We will have to go deal with those bugs this\n      Sprint.\n    </p>\n  ),\n  actions: {},\n};\n","import React from 'react';\nimport type { GremlinList } from '../../state';\n\nexport type GremlinId =\n  | 'GREMLIN_MANAGEMENT_YELLS'\n  | 'GREMLIN_EMERGENCY_ON_OTHER_TEAM'\n  | 'GREMLIN_NOT_PULLING_THEIR_WEIGHT'\n  | 'GREMLIN_NOT_AT_DAILY_SCRUM';\n\nexport const gremlins: GremlinList<GremlinId> = {\n  GREMLIN_MANAGEMENT_YELLS: {\n    name: 'Management yells at a team member in public',\n    probability: () => 10,\n    description: (\n      <p>\n        Management yells at a team member in public for not pulling their\n        weight. The team member who was yelled at feels their personal status\n        was reduced. The whole team fears they will be next.&nbsp; If you have\n        already implemented: Protection from Outside Distraction, this will\n        eliminate the effect.\n      </p>\n    ),\n    effect(age, finishedActionIds) {\n      if (finishedActionIds.includes('PROTECTED_FROM_OUTSIDE_DISTRACTION')) {\n        // TODO - Hannes are we better to return null or 0 capacity change with details on why zero?\n        return null;\n      }\n      return {\n        // TODO - Hannes did I get this wrong? I want this effect to be permanent - even if they add the PROTECTED_FROM_OUTSIDE_DISTRACTION later\n        capacityChange: -2,\n        title: 'Management yells at a team member in public',\n      };\n    },\n  },\n  GREMLIN_EMERGENCY_ON_OTHER_TEAM: {\n    probability: () => 10,\n    name: 'Emergency on other team',\n    description: (\n      <p>\n        Your best tester is needed by another team for a while.&nbsp; If you\n        have already implemented: Cross Skilling, External Cross Training or\n        Protection from Outside Distraction, they will reduce effects.\n      </p>\n    ),\n    effect(age, finishedActionIds) {\n      if (\n        age >= 3 ||\n        (finishedActionIds.includes('PROTECTED_FROM_OUTSIDE_DISTRACTION') &&\n          age >= 2)\n      ) {\n        return null;\n      }\n\n      let capacity = -3;\n\n      if (finishedActionIds.includes('CROSS_SKILLING')) {\n        capacity += 1;\n      }\n      if (finishedActionIds.includes('EXTERNAL_CROSS_TRAINING')) {\n        capacity += 1;\n      }\n\n      return {\n        // TODO Hannes - why does this have to be an assignment like the one I did above\n        capacityChange: capacity,\n        title:\n          'Weve had an emergency on another team, we need your best tester for a while.',\n      };\n    },\n  },\n  GREMLIN_NOT_PULLING_THEIR_WEIGHT: {\n    probability: () => 10,\n    name: \"Team member isn't pulling their weight\",\n    description: (\n      <p>\n        One of the people on your team isnt pulling their weight - not even\n        close. However, nothing seems to get done about it. The rest of the team\n        is pulling together and taking this persons work on, but its harming\n        morale and productivity. &nbsp; If you have already implemented: A\n        ScrumMaster conducts one on ones - you will be working on the problem\n        already; Cross Skilling - the problem person is more likely to grow\n        because they see others and learn from them.\n      </p>\n    ),\n    effect(age, finishedActionIds) {\n      let capacityChange = -2;\n      if (\n        finishedActionIds.includes('ONE_ON_ONES') ||\n        finishedActionIds.includes('CROSS_SKILLING')\n      ) {\n        capacityChange = -1;\n      }\n      return {\n        capacityChange: capacityChange,\n        title: \"Team member isn't pulling their weight\",\n      };\n    },\n  },\n  GREMLIN_NOT_AT_DAILY_SCRUM: {\n    probability: () => 10,\n    name: 'Team Member consistently late or misses Daily Scrum',\n    description: (\n      <p>\n        When one team member is consistently late - or, worse, missing - they\n        signal disrespect to their team. Other team members are annoyed that\n        this person does that to them. &nbsp; ScrumMaster Conducts One on Ones -\n        you will become aware of the problem early; Working Agreements - empower\n        team members to raise the issue.\n      </p>\n    ),\n    effect(age, finishedActionIds) {\n      let capacityChange = -1;\n      if (\n        finishedActionIds.includes('ONE_ON_ONES') ||\n        finishedActionIds.includes('WORKING_AGREEMENTS')\n      ) {\n        capacityChange = 0;\n      }\n      return {\n        capacityChange: capacityChange,\n        title: 'Team Member consistently late or misses Daily Scrum',\n      };\n    },\n  },\n};\n","import { findGameActionById, GameEffect } from '../../state';\n\nexport const gameEffects: { [key: string]: GameEffect } = {\n  technicalDebtDrag(rounds) {\n    let roundsWithoutEngAction = 0;\n\n    for (const round of rounds) {\n      const roundsGameActions = round.selectedGameActionIds.map(\n        findGameActionById,\n      );\n      const engineeringAction = roundsGameActions.find(\n        ({ type }) => type === 'ENGINEERING',\n      );\n\n      if (engineeringAction) {\n        break;\n      }\n\n      roundsWithoutEngAction += 1;\n    }\n\n    if (roundsWithoutEngAction === 0) {\n      return null;\n    }\n\n    return {\n      capacityChange: -roundsWithoutEngAction,\n      title: 'TechnicalDebt Drag Effect',\n      description: `No Engineering improvement for ${roundsWithoutEngAction} round${\n        roundsWithoutEngAction > 1 ? 's' : ''\n      }`,\n    };\n  },\n  communicationDebtDrag(rounds) {\n    let roundsWithoutCommunicationAction = 0;\n\n    for (const round of rounds) {\n      const roundsGameActions = round.selectedGameActionIds.map(\n        findGameActionById,\n      );\n      const communicationAction = roundsGameActions.find(\n        ({ type }) => type === 'COMMUNICATION',\n      );\n\n      if (communicationAction) {\n        break;\n      }\n\n      roundsWithoutCommunicationAction += 1;\n    }\n\n    if (roundsWithoutCommunicationAction === 0) {\n      return null;\n    }\n\n    return {\n      capacityChange: -roundsWithoutCommunicationAction,\n      title: 'Communication Drag Effect Title',\n      description: `No Communication improvement for ${roundsWithoutCommunicationAction} round${\n        roundsWithoutCommunicationAction > 1 ? 's' : ''\n      }`,\n    };\n  },\n};\n","import { Effect, VisibleEffect } from './types';\nimport { EFFECT_HIDDEN } from '../../constants';\n\nexport function isEffect(e: Effect | null): e is Effect {\n  return e !== null;\n}\n\nexport function isVisibleEffect(e: Effect): e is VisibleEffect {\n  return e.title !== EFFECT_HIDDEN;\n}\n","import { Effect, isEffect } from '../effects';\nimport { rounds } from '../../config';\nimport { GameState } from 'state/game';\n\nexport function getRoundEffects(\n  state: Pick<GameState, 'currentRound' | 'pastRounds'>,\n): Effect[] {\n  const currentRound = state.pastRounds.length + 1;\n  const roundEffects: (null | Effect)[] = [];\n\n  for (let i = 0; i < currentRound; i++) {\n    const desc = rounds[i + 1];\n    if (!desc) {\n      continue;\n    }\n    const previousRounds = state.pastRounds.slice(0, i);\n    const effect = desc.effect?.(previousRounds, currentRound) || null;\n\n    if (Array.isArray(effect)) {\n      roundEffects.push(...effect);\n    } else {\n      roundEffects.push(effect);\n    }\n  }\n\n  /* Since gremlins are rolled at the end of previous round we need to look\n   * at the next rounds effect for gremlin modification */\n  const nextRoundEffect =\n    rounds[currentRound + 1]?.effect?.(\n      [...state.pastRounds, state.currentRound],\n      currentRound + 1,\n    ) || [];\n  const nextRoundEffects = Array.isArray(nextRoundEffect)\n    ? nextRoundEffect\n    : [nextRoundEffect];\n  const nextRoundGremlinEffects = nextRoundEffects\n    .filter((effect) => effect.gremlinChange !== undefined)\n    .map((effect) => ({\n      ...effect,\n      /* Next rounds userStoryChange and capacityChange must not be active this round */\n      userStoryChange: undefined,\n      capacityChange: undefined,\n    }));\n\n  return roundEffects.filter(isEffect).concat(nextRoundGremlinEffects);\n}\n","import { rounds, GameActionId } from '../../config';\nimport { GameAction } from './types';\n\n/* create a flat list of actions from all rounds actions */\nexport const gameActions = Object.entries(rounds).reduce(\n  (memo, [roundNumber, round]) =>\n    memo.concat(\n      Object.entries(round.actions).map(([actionId, action]) => ({\n        ...action,\n        round: parseInt(roundNumber),\n        id: actionId as GameActionId,\n      })),\n    ),\n  [] as GameAction[],\n);\n","import { GameActionId } from '../../config';\nimport { GameAction } from './types';\nimport { gameActions } from './gameActions';\n\nexport function findGameActionById(gameActionId: GameActionId): GameAction {\n  const gameAction = gameActions.find(\n    (gameAction) => gameActionId === gameAction.id,\n  );\n\n  if (!gameAction) {\n    throw new Error(\n      `Could not find GameAction with id ${gameActionId}. Are you sure it is registered?`,\n    );\n  }\n\n  return gameAction;\n}\n","import { GameActionId } from '../../config';\nimport { GameAction } from './types';\nimport { gameActions } from './gameActions';\nimport { findGameActionById } from './findGameActionById';\n\nexport const UNIQUE = Symbol('UNIQUE');\n\ntype Times = typeof UNIQUE | number;\ntype GameActionStatus = {\n  dependencies: (GameAction & { missing: boolean })[];\n} & (\n  | { type: 'MISSING_DEP' }\n  | { type: 'AVAILABLE'; times: Times }\n  | { type: 'SELECTED'; times: Times }\n  | { type: 'FINISHED' }\n);\n\nfunction getDependencies(gameAction: GameAction): GameActionId[] {\n  const req = gameAction.available?.requires;\n  if (!req) {\n    return [];\n  }\n  if (!Array.isArray(req)) {\n    return [req];\n  }\n  return req;\n}\n\nexport type GameActionWithStatus = {\n  gameAction: GameAction;\n  status: GameActionStatus;\n};\n\nexport function getAvailableGameActions(\n  currentRound: number,\n  finishedActionIds: GameActionId[],\n  selectedGameActionIds: GameActionId[],\n): GameActionWithStatus[] {\n  return gameActions\n    .map((gameAction): GameActionWithStatus | null => {\n      if (currentRound < gameAction.round) {\n        return null;\n      }\n\n      const allDependencies = getDependencies(gameAction);\n      const unmetDependencies = allDependencies.filter(\n        (id) => !finishedActionIds.includes(id),\n      );\n      const dependencies = allDependencies\n        .map(findGameActionById)\n        .map((gameAction) => ({\n          ...gameAction,\n          missing: unmetDependencies.includes(gameAction.id),\n        }));\n\n      if (unmetDependencies.length) {\n        return {\n          gameAction,\n          status: {\n            type: 'MISSING_DEP',\n            dependencies,\n          },\n        };\n      }\n\n      const times =\n        gameAction.available?.unique === false\n          ? selectedGameActionIds.filter((id) => id === gameAction.id).length\n          : UNIQUE;\n\n      if (times === UNIQUE && finishedActionIds.includes(gameAction.id)) {\n        return {\n          gameAction,\n          status: { type: 'FINISHED', dependencies },\n        };\n      }\n\n      return {\n        gameAction,\n        status: selectedGameActionIds.includes(gameAction.id)\n          ? {\n              type: 'SELECTED',\n              times,\n              dependencies,\n            }\n          : { type: 'AVAILABLE', times, dependencies },\n      };\n    })\n    .filter((e): e is GameActionWithStatus => e !== null);\n}\n","import { GameActionId } from '../../config';\nimport { Effect } from '../effects';\nimport { findGameActionById } from './findGameActionById';\n\nexport function getEffects(\n  gameActionId: GameActionId,\n  age: number,\n  finishedActionIds: GameActionId[],\n): Effect[] {\n  const gameAction = findGameActionById(gameActionId);\n  const effect = gameAction.effect?.(age, finishedActionIds) || null;\n  if (effect === null) {\n    return [];\n  }\n  if (Array.isArray(effect)) {\n    return effect;\n  }\n\n  const fallbackTitle: Effect['title'] = `${gameAction.name} active`;\n\n  return [\n    {\n      title: fallbackTitle,\n      ...effect,\n    } as Effect,\n  ];\n}\n","import { sumByProp } from 'lib';\nimport { random } from 'lib/random';\nimport { ReactElement } from 'react';\nimport { GameActionId, GremlinId, gremlins } from '../config';\nimport { Effect } from './effects';\nimport { GameState, getAllEffects } from './game';\nimport { GameRound } from './round';\n\nexport type GremlinDescription = {\n  name: string;\n  description?: ReactElement;\n};\ntype GremlinImplementation = GremlinDescription & {\n  probability: (state: GameState) => number;\n  effect: (\n    age: number,\n    finishedActionIds: GameActionId[],\n  ) => null | Effect | Effect[];\n};\nexport type GremlinList<K extends string> = {\n  [k in K]: GremlinImplementation;\n};\n\nexport function rollGremlin(state: GameState): GremlinId | null {\n  const gremlinArray = Object.entries(gremlins).map(([id, gremlin]) => ({\n    id: id as GremlinId,\n    ...gremlin,\n  }));\n\n  const allEffects = getAllEffects(state);\n  const gremlinChance = sumByProp(allEffects, 'gremlinChange');\n\n  if (random() * 100 > gremlinChance) {\n    return null;\n  }\n\n  const pastGremlinIds = [state.currentRound, ...state.pastRounds]\n    .map((round) => round.gremlin)\n    .filter(isGremlinId);\n\n  const newGremlinsWithProbability = gremlinArray\n    .map((gremlin) => ({\n      ...gremlin,\n      currentProbability: gremlin.probability(state),\n    }))\n    .filter(\n      (gremlin) =>\n        !pastGremlinIds.includes(gremlin.id) && gremlin.currentProbability > 0,\n    );\n\n  const totalProbability = sumByProp(\n    newGremlinsWithProbability,\n    'currentProbability',\n  );\n\n  if (totalProbability === 0) {\n    return null;\n  }\n\n  let roll = random() * totalProbability;\n  let gremlin = newGremlinsWithProbability.shift();\n  while (roll > (gremlin?.currentProbability || Infinity)) {\n    roll -= gremlin?.currentProbability || Infinity;\n    gremlin = newGremlinsWithProbability.shift();\n  }\n\n  return gremlin?.id || null;\n}\n\nexport function isGremlinId(thing: GremlinId | null): thing is GremlinId {\n  return thing !== null;\n}\n\nexport function getGremlinEffects(\n  round: GameRound,\n  age: number,\n  finishedActionIds: GameActionId[],\n): Effect[] {\n  if (round.gremlin) {\n    const effect = gremlins[round.gremlin].effect(age, finishedActionIds);\n    if (Array.isArray(effect)) {\n      return effect;\n    }\n    if (effect) {\n      return [effect];\n    }\n  }\n\n  return [];\n}\n\nexport function getGremlin(\n  round: GameRound,\n): (GremlinDescription & GremlinImplementation) | undefined {\n  if (!round.gremlin) {\n    return;\n  }\n\n  return gremlins[round.gremlin];\n}\n","import {\n  GameRound,\n  ClosedGameRound,\n  createRound,\n  closeRound,\n  getActionEffects,\n} from './round';\nimport { Effect, isEffect } from './effects';\nimport { concatByProp } from '../lib';\nimport { GameActionId, gameEffects, GremlinId } from '../config';\nimport { getRoundEffects } from './rounds';\nimport { getEffects } from './gameActions';\nimport { getGremlinEffects } from './gremlins';\nimport { SIMULATED_TRAILING_ROUNDS } from '../constants';\n\nexport type GameState = {\n  currentRound: GameRound;\n  pastRounds: ClosedGameRound[];\n  ui: {\n    review: false | number;\n    view: 'welcome' | 'actions' | 'results';\n    closedRound?: ClosedGameRound;\n  };\n  log: RunningGameAction[];\n};\n\nexport type RestartGameAction = {\n  type: 'RESTART_GAME';\n};\nexport type SetUiReviewAction = {\n  type: 'SET_UI_REVIEW_ACTION';\n  payload: GameState['ui']['review'];\n};\nexport type SetUiViewAction = {\n  type: 'SET_UI_VIEW_ACTION';\n  payload: GameState['ui']['view'];\n};\nexport type SetUiClosedRoundAction = {\n  type: 'SET_UI_CLOSED_ROUND_ACTION';\n  payload: ClosedGameRound;\n};\nexport type SelectGameActionAction = {\n  type: 'SELECT_GAME_ACTION';\n  payload: GameActionId;\n};\nexport type UnselectGameActionAction = {\n  type: 'UNSELECT_GAME_ACTION';\n  payload: GameActionId;\n};\nexport type NextRoundAction = {\n  type: 'NEXT_ROUND';\n  payload: {\n    closedRound: ClosedGameRound;\n    gremlin: GremlinId | null;\n  };\n};\nexport type FinishGameAction = {\n  type: 'FINISH_GAME';\n  payload: {\n    closedRound: ClosedGameRound;\n  };\n};\nexport type GameActionAction =\n  | SelectGameActionAction\n  | UnselectGameActionAction;\ntype RunningGameAction = GameActionAction | NextRoundAction;\ntype UiAction = SetUiViewAction | SetUiClosedRoundAction | SetUiReviewAction;\n\nexport type Action =\n  | RunningGameAction\n  | RestartGameAction\n  | FinishGameAction\n  | UiAction;\n\nexport const INITIAL_STATE: GameState = {\n  currentRound: {\n    gremlin: null,\n    selectedGameActionIds: [],\n  },\n  pastRounds: [],\n  ui: {\n    review: false,\n    view: 'welcome',\n  },\n  log: [],\n};\n\nexport function getAllEffects(\n  state: Pick<GameState, 'currentRound' | 'pastRounds'>,\n  finishedActionIds: GameActionId[] = concatByProp(\n    state.pastRounds,\n    'selectedGameActionIds',\n  ),\n) {\n  const effects: Effect[] = [];\n\n  /* Base round effects of past rounds */\n  effects.push(...getRoundEffects(state));\n\n  /* Current rounds effects */\n  state.currentRound.selectedGameActionIds.forEach((id) => {\n    const currentRoundEffects = getEffects(id, 0, finishedActionIds);\n\n    currentRoundEffects.forEach((effect) => {\n      if (\n        effect.userStoryChange !== undefined ||\n        effect.gremlinChange !== undefined\n      ) {\n        /* Unset capacityChange because it only gets active in next round */\n        effects.push({ ...effect, capacityChange: undefined });\n      }\n    });\n  });\n\n  /* current rounds gremlin */\n  effects.push(...getGremlinEffects(state.currentRound, 0, finishedActionIds));\n\n  /* Get action and gremlin effects from past rounds */\n  const roundAmounts = state.pastRounds.length;\n  state.pastRounds.forEach((round, i) => {\n    const age = roundAmounts - i;\n\n    effects.push(\n      /* gremlins occur on current round, so they're at age +1 in next */\n      ...getGremlinEffects(round, age, finishedActionIds),\n      /* actions get active in next */\n      ...getActionEffects(round, age, finishedActionIds).filter(isEffect),\n    );\n  });\n\n  /* Add game Effects */\n  Object.values(gameEffects).forEach((gameEffect) => {\n    const effect = gameEffect(state.pastRounds);\n    if (Array.isArray(effect)) {\n      effects.push(...effect);\n    } else if (effect) {\n      effects.push(effect);\n    }\n  });\n\n  return effects;\n}\n\nexport function getCapacity(effects: Effect[]) {\n  return effects.reduce((capacity, effect) => {\n    return capacity + (effect.capacityChange || 0);\n  }, 0);\n}\n\nfunction nextRound(state: GameState, action: NextRoundAction): GameState {\n  return {\n    ...state,\n    ui: {\n      review: false,\n      view: 'welcome',\n    },\n    pastRounds: [...state.pastRounds, action.payload.closedRound],\n    currentRound: createRound(action.payload.gremlin),\n    log: state.log.concat(action),\n  };\n}\n\nexport function gameReducer(state: GameState, action: Action): GameState {\n  switch (action.type) {\n    case 'SELECT_GAME_ACTION': {\n      return {\n        ...state,\n        currentRound: {\n          ...state.currentRound,\n          selectedGameActionIds: [\n            ...state.currentRound.selectedGameActionIds,\n            action.payload,\n          ],\n        },\n        log: state.log.concat(action),\n      };\n    }\n    case 'UNSELECT_GAME_ACTION': {\n      return {\n        ...state,\n        currentRound: {\n          ...state.currentRound,\n          selectedGameActionIds: state.currentRound.selectedGameActionIds.filter(\n            (id) => id !== action.payload,\n          ),\n        },\n        log: state.log.concat(action),\n      };\n    }\n    case 'NEXT_ROUND': {\n      return nextRound(state, action);\n    }\n    case 'FINISH_GAME': {\n      return Array.from({ length: SIMULATED_TRAILING_ROUNDS + 1 }).reduce<\n        [GameState, ClosedGameRound]\n      >(\n        ([state, closedRound]) => {\n          const nextState = nextRound(state, {\n            type: 'NEXT_ROUND',\n            payload: {\n              closedRound,\n              gremlin: null,\n            },\n          });\n\n          return [nextState, closeRound(nextState)];\n        },\n        [state, action.payload.closedRound],\n      )[0];\n    }\n    case 'SET_UI_VIEW_ACTION':\n      return {\n        ...state,\n        ui: {\n          ...state.ui,\n          view: action.payload,\n        },\n      };\n    case 'SET_UI_CLOSED_ROUND_ACTION':\n      return {\n        ...state,\n        ui: {\n          ...state.ui,\n          view: 'results',\n          closedRound: action.payload,\n        },\n      };\n    case 'SET_UI_REVIEW_ACTION':\n      return {\n        ...state,\n        ui: {\n          ...state.ui,\n          view: 'welcome',\n          review: action.payload,\n        },\n      };\n    case 'RESTART_GAME':\n      return INITIAL_STATE;\n  }\n}\n","import { sumByProp, storySucceeds, concatByProp } from '../lib';\nimport { GameActionId, GremlinId, rounds } from '../config';\nimport { GameState, getCapacity, getAllEffects } from './game';\nimport {\n  findGameActionById,\n  getCost as getActionCost,\n  getEffects,\n} from './gameActions';\nimport { Effect, isEffect, isVisibleEffect, VisibleEffect } from './effects';\nimport { getGremlin, GremlinDescription } from './gremlins';\nimport { ReactNode } from 'react';\nimport { GameAction } from './gameActions/types';\n\nexport type GameRound = {\n  gremlin: GremlinId | null;\n  selectedGameActionIds: GameActionId[];\n};\nexport type ClosedGameRound = GameRound & {\n  storiesCompleted: number;\n};\nexport type AppRound = {\n  number: number;\n  title?: string;\n  gremlin?: GremlinDescription & {\n    effect: VisibleEffect[];\n  };\n  description?: ReactNode;\n  selectedGameActions: GameAction[];\n  capacity: {\n    available: number;\n    total: number;\n  };\n  gremlinChance: number;\n  userStoryChance: number;\n  activeEffects: VisibleEffect[];\n};\n\nexport function createRound(gremlin: GremlinId | null): GameRound {\n  return {\n    gremlin,\n    selectedGameActionIds: [],\n  };\n}\n\nexport function getActionEffects(\n  round: ClosedGameRound,\n  age: number,\n  finishedActionIds: GameActionId[],\n): Effect[] {\n  const effects: Effect[] = [];\n  round.selectedGameActionIds.forEach((id) => {\n    effects.push(...getEffects(id, age, finishedActionIds));\n  });\n  return effects;\n}\n\nexport function getCosts(round: GameRound) {\n  return sumByProp(\n    round.selectedGameActionIds.map((id) => ({\n      cost: getActionCost(findGameActionById(id)),\n    })),\n    'cost',\n  );\n}\n\nexport function closeRound(state: GameState): ClosedGameRound {\n  const effects = getAllEffects(state);\n  const storiesAttempted = getCapacity(effects) - getCosts(state.currentRound);\n\n  const chance = sumByProp(effects, 'userStoryChange');\n\n  return {\n    ...state.currentRound,\n    storiesCompleted:\n      storiesAttempted <= 0\n        ? 0\n        : Array.from({ length: storiesAttempted }).filter(() =>\n            storySucceeds(chance),\n          ).length,\n  };\n}\n\nfunction orZero(num: number): number {\n  return num < 0 ? 0 : num;\n}\n\nexport function deriveAppRound(\n  state: Pick<GameState, 'currentRound' | 'pastRounds'>,\n): AppRound {\n  const finishedActionIds = concatByProp(\n    state.pastRounds,\n    'selectedGameActionIds',\n  );\n  const effects = getAllEffects(state, finishedActionIds);\n  const roundCapacity = orZero(getCapacity(effects));\n  const visibleEffects = effects.filter(isVisibleEffect);\n  const totalUserStoryChance = sumByProp(effects, 'userStoryChange');\n  const costs = getCosts(state.currentRound);\n  const capacityAvailable = orZero(roundCapacity - costs);\n  const currentRoundNumber = state.pastRounds.length + 1;\n  const selectedGameActions = state.currentRound.selectedGameActionIds.map(\n    findGameActionById,\n  );\n  const currentRoundTitle = rounds[currentRoundNumber]?.title;\n  const currentRoundDescription = rounds[currentRoundNumber]?.description;\n  const gremlin = getGremlin(state.currentRound);\n  const gremlinEffect = gremlin?.effect(0, finishedActionIds) || null;\n  const visibleGremlinEffects = (Array.isArray(gremlinEffect)\n    ? gremlinEffect\n    : [gremlinEffect]\n  )\n    .filter(isEffect)\n    .filter(isVisibleEffect);\n\n  return {\n    selectedGameActions,\n    title: currentRoundTitle,\n    description: currentRoundDescription,\n    gremlin: gremlin\n      ? {\n          name: gremlin.name,\n          description: gremlin.description,\n          effect: visibleGremlinEffects,\n        }\n      : undefined,\n    number: currentRoundNumber,\n    capacity: {\n      available: capacityAvailable,\n      total: roundCapacity,\n    },\n    gremlinChance: sumByProp(effects, 'gremlinChange'),\n    userStoryChance: totalUserStoryChance,\n    activeEffects: visibleEffects,\n  };\n}\n","import { GameAction } from './types';\n\nexport function getCost(gameAction: GameAction): number {\n  return gameAction.cost;\n}\n","import { random } from './random';\n\nexport function storySucceeds(chance: number) {\n  return random() * 100 < chance;\n}\n","import { Dispatch, useReducer } from 'react';\nimport { concatByProp, usePersistState, useStateLink } from '../lib';\nimport { Action, gameReducer, GameState } from './game';\nimport { getAvailableGameActions } from './gameActions';\nimport { GameActionWithStatus } from './gameActions/getAvailableGameActions';\nimport { rollGremlin } from './gremlins';\nimport { AppRound, ClosedGameRound, closeRound, deriveAppRound } from './round';\nimport { GremlinId } from '../config';\n\ntype PastRound = AppRound & {\n  storiesCompleted: number;\n};\n\nexport type AppState = {\n  availableGameActions: GameActionWithStatus[];\n  currentRound: AppRound;\n  pastRounds: PastRound[];\n  link: string;\n  ui: GameState['ui'];\n  log: GameState['log'];\n};\n\nexport default function useAppState(\n  initialState: GameState,\n): [AppState, Dispatch<Action>, () => ClosedGameRound, () => GremlinId | null] {\n  const [gameState, dispatch] = useReducer(gameReducer, initialState);\n  usePersistState(gameState);\n  const link = useStateLink(gameState);\n\n  const state: GameState =\n    gameState.ui.review === false\n      ? gameState\n      : {\n          currentRound: gameState.pastRounds[gameState.ui.review],\n          pastRounds: gameState.pastRounds.slice(0, gameState.ui.review),\n          ui: {\n            ...gameState.ui,\n            closedRound: gameState.pastRounds[gameState.ui.review],\n          },\n          log: gameState.log,\n        };\n\n  const availableGameActions = getAvailableGameActions(\n    state.pastRounds.length + 1,\n    concatByProp(state.pastRounds, 'selectedGameActionIds'),\n    state.currentRound.selectedGameActionIds,\n  );\n\n  return [\n    {\n      availableGameActions,\n      currentRound: deriveAppRound(state),\n      pastRounds: state.pastRounds.map((round, i) => {\n        const pastRounds = state.pastRounds.slice(0, i);\n        const currentRound = state.pastRounds[i];\n\n        return {\n          ...deriveAppRound({\n            pastRounds,\n            currentRound,\n          }),\n          storiesCompleted: round.storiesCompleted,\n        };\n      }),\n      link,\n      ui: state.ui,\n      log: state.log,\n    },\n    dispatch,\n    () => closeRound(state),\n    () => rollGremlin(state),\n  ];\n}\n","import React, { useMemo } from 'react';\nimport {\n  ComposedChart,\n  Line,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer,\n} from 'recharts';\nimport { AppRound } from '../state';\nimport styles from './CapStoryChart.module.css';\n\nconst USC = 'Chance of completing User Stories';\nconst SA = 'User Stories Attempted';\nconst SC = 'User Stories Completed';\nconst TC = 'Total Capacity';\n\ntype Data = {\n  name: string;\n  [USC]: number;\n  [TC]: number;\n  [SA]: number;\n  [SC]?: number;\n};\ntype Props = {\n  rounds: (AppRound & {\n    storiesCompleted: number | undefined;\n  })[];\n};\n\nexport default function CapStoryChart({ rounds }: Props) {\n  const [data, userStorySteps] = useMemo(() => {\n    const data: Data[] = [];\n    let maxUserStoryChance = 100;\n\n    rounds.forEach((round, i) => {\n      maxUserStoryChance = Math.max(\n        maxUserStoryChance,\n        Math.ceil(round.userStoryChance / 10) * 10,\n      );\n      data.push({\n        name: `Round ${i + 1}`,\n        [USC]: round.userStoryChance,\n        [TC]: round.capacity.total,\n        [SA]: round.capacity.available,\n        [SC]: round.storiesCompleted,\n      });\n    });\n    return [\n      data,\n      Array.from({ length: 1 + maxUserStoryChance / 10 }).map((_, i) => i * 10),\n    ];\n  }, [rounds]);\n\n  return (\n    <ResponsiveContainer className={styles.chart} height={300} width=\"100%\">\n      <ComposedChart\n        data={data}\n        margin={{\n          top: 5,\n          right: 30,\n          left: 20,\n          bottom: 5,\n        }}\n      >\n        <CartesianGrid strokeDasharray=\"3 3\" />\n        <XAxis dataKey=\"name\" />\n        <YAxis yAxisId=\"right\" orientation=\"right\" />\n        <YAxis\n          yAxisId=\"left\"\n          orientation=\"left\"\n          unit=\"%\"\n          ticks={userStorySteps}\n        />\n        <Tooltip />\n        <Legend />\n        <Bar\n          yAxisId=\"left\"\n          dataKey={USC}\n          fill=\"#e2d02f\"\n          unit=\"%\"\n          barSize={30}\n        />\n        <Line yAxisId=\"right\" type=\"monotone\" dataKey={TC} stroke=\"#0c79df\" />\n        <Line yAxisId=\"right\" type=\"monotone\" dataKey={SA} stroke=\"#cd66e7\" />\n        <Line yAxisId=\"right\" type=\"monotone\" dataKey={SC} stroke=\"#1be400\" />\n      </ComposedChart>\n    </ResponsiveContainer>\n  );\n}\n","import React, { ButtonHTMLAttributes } from 'react';\nimport cx from 'classnames';\nimport styles from './Button.module.css';\n\ntype Props = ButtonHTMLAttributes<HTMLButtonElement> & {\n  primary?: boolean;\n};\n\nexport default function Button({ primary, className, ...rest }: Props) {\n  return (\n    <button\n      className={cx(className, styles.button, primary && styles.primary)}\n      {...rest}\n    />\n  );\n}\n","import { restartGame, sumByProp } from 'lib';\nimport React from 'react';\nimport { AppState, GameDispatch } from 'state';\nimport CapStoryChart from './CapStoryChart';\nimport Button from './Button';\n\ntype Props = {\n  state: AppState;\n  dispatch?: GameDispatch;\n};\n\nexport default function Results(props: Props) {\n  const storiesAttempted = sumByProp(\n    props.state.pastRounds.map((round) => ({\n      storiesAttempted: round.capacity.available,\n    })),\n    'storiesAttempted',\n  );\n  const storiesCompleted = sumByProp(\n    props.state.pastRounds,\n    'storiesCompleted',\n  );\n  const dispatch = props.dispatch;\n  return (\n    <>\n      <h2>Results</h2>\n      <ul>\n        <li>Final Capacity {props.state.currentRound.capacity.total}</li>\n        <li>Attempted {storiesAttempted} user stories</li>\n        <li>Completed {storiesCompleted} user stories</li>\n      </ul>\n      {dispatch && (\n        <>\n          <Button\n            onClick={() =>\n              dispatch({ type: 'SET_UI_REVIEW_ACTION', payload: 0 })\n            }\n          >\n            Review Game\n          </Button>\n          <Button primary onClick={restartGame(dispatch)}>\n            Start New Game\n          </Button>\n        </>\n      )}\n      <CapStoryChart rounds={props.state.pastRounds} />\n      <h3>Game Link</h3>\n      <p>\n        You can save or share this link. Opening it will restore this current\n        game.\n      </p>\n      <pre>\n        <input\n          style={{ width: '100%' }}\n          value={props.state.link}\n          readOnly\n          onClick={(ev) => (ev.target as HTMLInputElement).select()}\n        />\n      </pre>\n    </>\n  );\n}\n","import React, { ReactElement } from 'react';\nimport { TOTAL_ROUNDS } from '../../constants';\nimport { AppState } from '../../state';\nimport styles from './Round.module.css';\n\ntype Props = {\n  currentRound: AppState['currentRound'];\n  ui: AppState['ui'];\n  welcome: ReactElement;\n  actions: ReactElement;\n  results?: ReactElement;\n};\n\nexport default function Round(props: Props) {\n  return (\n    <>\n      <h4 className={styles.number}>\n        Round {props.currentRound.number} of {TOTAL_ROUNDS}\n      </h4>\n      {props.currentRound.title && (\n        <h2 className={styles.title}>{props.currentRound.title}</h2>\n      )}\n      {props.ui.view === 'welcome' && props.welcome}\n      {props.ui.view === 'actions' && props.actions}\n      {props.ui.view === 'results' && props.results}\n    </>\n  );\n}\n","import React from 'react';\nimport { GremlinId } from '../../config';\nimport {\n  START_USER_STORY_CHANCE,\n  TOTAL_INTERACTIVE_ROUNDS,\n} from '../../constants';\nimport { AppState, GameDispatch, ClosedRound } from '../../state';\nimport Button from '../Button';\nimport CapStoryChart from '../CapStoryChart';\nimport styles from './Round.module.css';\n\ntype Props = {\n  ui: AppState['ui'];\n  pastRounds: AppState['pastRounds'];\n  currentRound: AppState['currentRound'];\n  closeRound: () => ClosedRound;\n  rollGremlin: () => GremlinId | null;\n  dispatch: GameDispatch;\n};\nexport default function Results(props: Props) {\n  const userStoryEffects = props.currentRound.activeEffects.filter(\n    (effect) => effect.userStoryChange !== undefined,\n  );\n\n  return (\n    <>\n      <p>What is the chance that each User Story will successfully be built?</p>\n      <p>\n        When you're ready to see the results click: \"Roll for User Stories\".\n      </p>\n      <p>When you have reviewed the results click: \"Next Round\"</p>\n      <h3>Calculation</h3>\n      <ul className={styles.userStoryChanceList}>\n        <li>&nbsp;&nbsp;&nbsp;{START_USER_STORY_CHANCE}% base chance</li>\n        {userStoryEffects.map((effect) => (\n          <li key={effect.title}>\n            {effect.userStoryChange! > 0 ? '+' : '-'}{' '}\n            {effect.userStoryChange!.toString().replace(/^-/, '')}%{' '}\n            {effect.title}\n          </li>\n        ))}\n        <li>\n          = {props.currentRound.userStoryChance}% chance to successful finish\n          user-story\n        </li>\n        <li>---</li>\n        {!props.ui.closedRound && (\n          <>\n            <li>\n              x &nbsp; {props.currentRound.capacity.available} working capacity\n              that you elected to spend on user stories\n            </li>\n            <li>&nbsp;</li>\n          </>\n        )}\n        {props.ui.closedRound && (\n          <>\n            <li>\n              {props.currentRound.capacity.available} user stories attempted\n            </li>\n            <li>\n              {props.ui.closedRound.storiesCompleted} user stories completed\n            </li>\n          </>\n        )}\n      </ul>\n      <ul className={styles.userStoryIcons}>\n        {Array(props.currentRound.capacity.available)\n          .fill('')\n          .map((_, i) => (\n            <li key={i}>\n              {!props.ui.closedRound\n                ? ''\n                : i < props.ui.closedRound.storiesCompleted\n                ? ''\n                : ''}\n            </li>\n          ))}\n      </ul>\n      <div className={styles.center}>\n        {props.ui.review === false ? (\n          <Button\n            disabled={!!props.ui.closedRound}\n            onClick={() => {\n              props.dispatch({\n                type: 'SET_UI_CLOSED_ROUND_ACTION',\n                payload: props.closeRound(),\n              });\n            }}\n          >\n            Roll for User Stories\n          </Button>\n        ) : (\n          <Button\n            onClick={() => {\n              props.dispatch({\n                type: 'SET_UI_VIEW_ACTION',\n                payload: 'actions',\n              });\n            }}\n          >\n             Back\n          </Button>\n        )}\n        <Button\n          primary\n          disabled={!props.ui.closedRound}\n          onClick={() => {\n            if (props.ui.review !== false) {\n              const nextRound = props.ui.review + 1;\n              props.dispatch({\n                type: 'SET_UI_REVIEW_ACTION',\n                payload:\n                  nextRound < TOTAL_INTERACTIVE_ROUNDS ? nextRound : false,\n              });\n\n              return;\n            }\n            if (!props.ui.closedRound) {\n              throw new Error(\n                'Can not go to next round without closing this one',\n              );\n            }\n\n            if (props.pastRounds.length + 1 === TOTAL_INTERACTIVE_ROUNDS) {\n              props.dispatch({\n                type: 'FINISH_GAME',\n                payload: {\n                  closedRound: props.ui.closedRound,\n                },\n              });\n            } else {\n              props.dispatch({\n                type: 'NEXT_ROUND',\n                payload: {\n                  closedRound: props.ui.closedRound,\n                  gremlin: props.rollGremlin(),\n                },\n              });\n            }\n          }}\n        >\n          {props.ui.review && props.ui.review + 1 >= TOTAL_INTERACTIVE_ROUNDS\n            ? 'Close Review'\n            : props.pastRounds.length + 1 === TOTAL_INTERACTIVE_ROUNDS\n            ? 'Finish Game'\n            : 'Next Round'}\n        </Button>\n      </div>\n      <CapStoryChart\n        rounds={[\n          ...props.pastRounds,\n          {\n            ...props.currentRound,\n            storiesCompleted: props.ui.closedRound?.storiesCompleted,\n          },\n        ]}\n      />\n    </>\n  );\n}\n","import React from 'react';\nimport { VisibleEffect } from '../state';\nimport styles from './EffectValue.module.css';\n\ntype Props = {\n  effect: VisibleEffect;\n};\n\nexport function Sign(props: { value: number; unit?: string }) {\n  return (\n    <span className={styles.value}>\n      {props.value > 0 ? '+' : '-'}\n      {String(props.value).replace(/^-/, '')}\n      {props.unit}\n    </span>\n  );\n}\n\nexport default function EffectValue(props: Props) {\n  return (\n    <>\n      {props.effect.capacityChange !== undefined && (\n        <>\n          <Sign value={props.effect.capacityChange} /> Capacity\n        </>\n      )}\n      {props.effect.gremlinChange !== undefined && (\n        <>\n          <Sign value={props.effect.gremlinChange} unit=\"%\" /> Chance of\n          Gremlins occurring\n        </>\n      )}\n      {props.effect.userStoryChange !== undefined && (\n        <>\n          <Sign value={props.effect.userStoryChange} unit=\"%\" /> Chance of User\n          Stories succeeding\n        </>\n      )}\n    </>\n  );\n}\n","import React, { ReactNode } from 'react';\nimport { AppState } from '../../state';\nimport EffectValue from '../EffectValue';\nimport styles from './Round.module.css';\n\nexport type Props = {\n  children: ReactNode;\n  gremlin: AppState['currentRound']['gremlin'];\n};\nexport default function RoundDescription(props: Props) {\n  return (\n    <>\n      {props.children ? (\n        <div className={styles.description}>{props.children}</div>\n      ) : null}\n      {props.gremlin && (\n        <>\n          <h3>Gremlin</h3>\n          Just happened:&nbsp;\n          <strong> {props.gremlin.name}</strong>\n          {props.gremlin.description}\n          <ul className={styles.gremlinEffects}>\n            {props.gremlin.effect.map((effect) => (\n              <li key={effect.title}>\n                <EffectValue effect={effect} />\n              </li>\n            ))}\n          </ul>\n        </>\n      )}\n    </>\n  );\n}\n","import React from 'react';\nimport { TOTAL_INTERACTIVE_ROUNDS } from '../../constants';\nimport { GameDispatch } from '../../state';\nimport Button from '../Button';\nimport Description, { Props as DescriptionProps } from './Description';\nimport styles from './Round.module.css';\n\ntype Props = DescriptionProps & {\n  review: false | number;\n  dispatch: GameDispatch;\n};\nexport default function Welcome(props: Props) {\n  const review = props.review;\n  return (\n    <>\n      <Description gremlin={props.gremlin}>{props.children}</Description>\n      <div className={styles.center}>\n        {review ? (\n          <Button\n            onClick={() => {\n              props.dispatch({\n                type: 'SET_UI_REVIEW_ACTION',\n                payload: review - 1,\n              });\n            }}\n          >\n             Round {review}\n          </Button>\n        ) : null}\n        <Button\n          primary\n          onClick={() => {\n            props.dispatch({ type: 'SET_UI_VIEW_ACTION', payload: 'actions' });\n          }}\n        >\n          {review === false ? 'Start Round' : 'Show Actions'}\n        </Button>\n        {review !== false && review + 1 < TOTAL_INTERACTIVE_ROUNDS ? (\n          <Button\n            onClick={() => {\n              props.dispatch({\n                type: 'SET_UI_REVIEW_ACTION',\n                payload: review + 1,\n              });\n            }}\n          >\n            Round {review + 2} \n          </Button>\n        ) : null}\n      </div>\n    </>\n  );\n}\n","import React, { useState, useRef, useEffect, ReactNode } from 'react';\nimport { usePopper } from 'react-popper';\nimport styles from './Actions.module.css';\n\ntype Props = {\n  title: ReactNode;\n  children: ReactNode;\n  referenceElement: HTMLElement | null;\n  onClose: () => void;\n};\n\nexport default function Overlay(props: Props) {\n  const referenceElement = props.referenceElement;\n  const onClose = props.onClose;\n  const overlayRef = useRef<HTMLDivElement | null>(null);\n  const [popperElement, setPopperElement] = useState<HTMLDivElement | null>(\n    null,\n  );\n  useEffect(() => {\n    const handler = (ev: MouseEvent) => {\n      if (!popperElement || !ev.target) {\n        return;\n      }\n      if (!popperElement.contains(ev.target as any)) {\n        onClose();\n      }\n    };\n    window.addEventListener('click', handler);\n\n    return () => window.removeEventListener('click', handler);\n  }, [popperElement, onClose]);\n\n  overlayRef.current = popperElement;\n  const [arrowElement, setArrowElement] = useState<HTMLDivElement | null>(null);\n  const popper = usePopper(referenceElement, popperElement, {\n    placement: 'bottom-end',\n    modifiers: [\n      {\n        name: 'offset',\n        options: {\n          offset: [0, 8],\n        },\n      },\n      {\n        name: 'flip',\n        options: {\n          fallbackPlacements: [\n            'bottom',\n            'bottom-start',\n            'top-end',\n            'top',\n            'top-start',\n            'right',\n          ],\n        },\n      },\n      { name: 'preventOverflow' },\n      { name: 'arrow', options: { element: arrowElement } },\n    ],\n  });\n\n  return (\n    <div\n      data-popper-placement={popper.state?.placement}\n      ref={setPopperElement}\n      className={styles.overlay}\n      style={popper.styles.popper}\n      {...popper.attributes}\n    >\n      <div\n        ref={setArrowElement}\n        style={popper.styles.arrow}\n        className={styles.arrow}\n      />\n      <div className={styles.overlayInner}>\n        <button className={styles.closeOverlay} onClick={() => props.onClose()}>\n          \n        </button>\n        <h3 className={styles.overlayTitle}>{props.title}</h3>\n        {props.children}\n      </div>\n    </div>\n  );\n}\n","import React, { HTMLAttributes } from 'react';\nimport cx from 'classnames';\nimport { GameAction, isGameActionWithImage } from '../../state';\nimport styles from './Actions.module.css';\n\ntype Props = Omit<HTMLAttributes<HTMLSpanElement>, 'children'> & {\n  gameAction: GameAction;\n};\nexport default function ActionImage({\n  gameAction,\n  className,\n  style,\n  ...rest\n}: Props) {\n  if (isGameActionWithImage(gameAction)) {\n    return (\n      <span\n        className={cx(styles.actionImage, className)}\n        style={{ backgroundImage: `url(${gameAction.image})`, ...style }}\n        {...rest}\n      />\n    );\n  }\n\n  return (\n    <span className={cx(styles.actionIcon, className)} style={style} {...rest}>\n      {gameAction.icon}\n    </span>\n  );\n}\n","import { ReactNode } from 'react';\nimport { GameActionId } from '../../config';\nimport { EffectDescription, BaseEffect, Effect } from '../effects';\n\ntype EffectWithOptionalTitle = Partial<EffectDescription> & BaseEffect;\nexport type AvailabilityCheck = (\n  currentRound: number,\n  finishedActionIds: GameActionId[],\n  selectedGameActionIds: GameActionId[],\n  id: GameActionId,\n) => boolean;\ntype Image = {\n  /**\n   * An image url\n   * can be externally hosted image\n   * `https://example.org/my.png`\n   * or relative file:\n   * `import imageUrl from './my.png';\n   */\n  image: string;\n};\nexport function isGameActionWithImage(\n  action: GameAction,\n): action is FullGameAction & Image {\n  return Object.getOwnPropertyNames(action).includes('image');\n}\ntype Icon = {\n  /**\n   * Unicode Character to be displayed instead of image\n   * can be emoji or any other char\n   */\n  icon: string;\n};\nexport function isGameActionWithIcon(\n  action: GameAction,\n): action is FullGameAction & Icon {\n  return Object.getOwnPropertyNames(action).includes('icon');\n}\ntype ImageOrIcon = Image | Icon;\n\ntype GameActionImplementation = {\n  type?: 'ENGINEERING' | 'COMMUNICATION';\n  available?: {\n    requires?: GameActionId[] | GameActionId;\n    unique?: false;\n  };\n  effect?: (\n    age: number,\n    finishedActionIds: GameActionId[],\n  ) => Effect[] | EffectWithOptionalTitle | null;\n  name: string;\n  description: ReactNode;\n  cost: number;\n};\ntype FullGameAction = GameActionImplementation & {\n  id: GameActionId;\n  round: number;\n};\nexport type GameActionList<T extends string> = {\n  [K in T]: ImageOrIcon & GameActionImplementation;\n};\n\nexport type GameAction = ImageOrIcon & FullGameAction;\n","import React, { useRef, useState } from 'react';\nimport cx from 'classnames';\nimport { GameActionWithStatus } from '../../state';\nimport styles from './Actions.module.css';\nimport Overlay from './Overlay';\nimport Button from '../Button';\nimport ActionImage from './ActionImage';\n\ntype ActionProps = GameActionWithStatus & {\n  review: boolean;\n  isOpen: boolean;\n  availableCapacity: number;\n  onOpen: (open: boolean) => void;\n  onSelect: (selected: boolean) => void;\n};\n\nexport default function Action(props: ActionProps) {\n  const [buttonElement, setButtonElement] = useState<HTMLButtonElement | null>(\n    null,\n  );\n  const clickTimer = useRef<NodeJS.Timeout>();\n  const gameAction = props.gameAction;\n\n  const disabled =\n    props.review ||\n    (props.status.type === 'AVAILABLE' &&\n      gameAction.cost > props.availableCapacity) ||\n    ['MISSING_DEP', 'FINISHED'].includes(props.status.type);\n\n  return (\n    <>\n      <button\n        ref={setButtonElement}\n        onClick={() => {\n          if (clickTimer.current) {\n            clearTimeout(clickTimer.current);\n          }\n          clickTimer.current = setTimeout(() => props.onOpen(true), 300);\n        }}\n        onDoubleClick={() => {\n          if (disabled) {\n            return;\n          }\n          if (clickTimer.current) {\n            clearTimeout(clickTimer.current);\n          }\n          props.onSelect(props.status.type === 'AVAILABLE');\n        }}\n        className={cx(\n          styles.action,\n          disabled && !props.review && styles.disabled,\n          props.status.type === 'MISSING_DEP' && styles.missingDep,\n          props.status.type === 'SELECTED' && styles.actionSelected,\n          props.status.type === 'FINISHED' && styles.actionFinished,\n        )}\n      >\n        <ActionImage gameAction={props.gameAction} />\n        <span>{props.gameAction.name}</span>\n      </button>\n      {props.isOpen && (\n        <Overlay\n          referenceElement={buttonElement}\n          title={props.gameAction.name}\n          onClose={() => props.onOpen(false)}\n        >\n          {props.status.dependencies.length ? (\n            <>\n              <h4 className={styles.requiresTitle}>Requires</h4>\n              <ul className={styles.requiresList}>\n                {props.status.dependencies.map((dep) => (\n                  <li key={dep.id}>\n                    {dep.missing ? '' : ''} {dep.name}\n                  </li>\n                ))}\n              </ul>\n            </>\n          ) : null}\n          {props.gameAction.description}\n          <p>\n            <b>Cost</b>: {props.gameAction.cost}\n          </p>\n          {!disabled && (\n            <Button\n              primary={props.status.type === 'AVAILABLE'}\n              onClick={() => {\n                props.onOpen(false);\n                props.onSelect(props.status.type === 'AVAILABLE');\n              }}\n            >\n              {props.status.type === 'SELECTED' ? 'Remove' : 'Select'}\n            </Button>\n          )}\n          {disabled && props.status.type === 'FINISHED' && (\n            <Button primary disabled>\n              Finished\n            </Button>\n          )}\n        </Overlay>\n      )}\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport { GameActionId } from '../../config';\nimport { GameActionWithStatus } from '../../state';\nimport styles from './Actions.module.css';\nimport Action from './Action';\n\ntype Props = {\n  round: number;\n  review: boolean;\n  initialVisible: boolean;\n  openGameActionId?: GameActionId;\n  availableCapacity: number;\n  onOpen: (open: boolean, id: GameActionId) => void;\n  onSelect: (selected: boolean, actionWithStatus: GameActionId) => void;\n  actionsWithStatus: GameActionWithStatus[];\n};\n\nexport default function RoundActions(props: Props) {\n  const [visible, setVisible] = useState(props.initialVisible);\n  return (\n    <>\n      <li>\n        <button\n          className={styles.roundVisibleToggle}\n          onClick={() => setVisible(!visible)}\n        >\n          Round {props.round} {visible ? '' : ''}\n        </button>\n        {visible && (\n          <ul className={styles.roundActionList}>\n            {props.actionsWithStatus.map(\n              /* eslint-disable-next-line array-callback-return */\n              (actionWithStatus): JSX.Element => {\n                return (\n                  <li key={actionWithStatus.gameAction.id}>\n                    <Action\n                      {...actionWithStatus}\n                      review={props.review}\n                      availableCapacity={props.availableCapacity}\n                      isOpen={\n                        props.openGameActionId ===\n                        actionWithStatus.gameAction.id\n                      }\n                      onOpen={(open) =>\n                        props.onOpen(open, actionWithStatus.gameAction.id)\n                      }\n                      onSelect={(selected) =>\n                        props.onSelect(selected, actionWithStatus.gameAction.id)\n                      }\n                    />\n                  </li>\n                );\n              },\n            )}\n          </ul>\n        )}\n      </li>\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport { GameActionId } from '../../config';\nimport { GameDispatch, AppState, GameActionWithStatus } from '../../state';\nimport styles from './Actions.module.css';\nimport RoundActions from './RoundActions';\n\nfunction onlyRound(number: number) {\n  return (actionWithStatus: GameActionWithStatus): boolean =>\n    actionWithStatus.gameAction.round === number;\n}\n\ntype Props = {\n  currentRound: number;\n  ui: AppState['ui'];\n  availableGameActions: AppState['availableGameActions'];\n  dispatch: GameDispatch;\n  availableCapacity: number;\n};\n\nexport default function Actions(props: Props) {\n  const [openActionId, setOpenActionId] = useState<GameActionId>();\n\n  return (\n    <>\n      <h2>Available Actions</h2>\n      <p>\n        Select Improvements or Actions that will affect the team. Once selected,\n        the cot of the Actions cost will be deducted from the team's Working Capacity.\n      </p>\n      <p>\n        Previous rounds actions are still available, click the &#9658; to open\n        prior rounds.\n      </p>\n      <ul className={styles.roundList}>\n        {Array(props.currentRound)\n          .fill('')\n          .map((_, i) => {\n            const round = props.currentRound - i;\n            return (\n              <RoundActions\n                review={props.ui.review !== false}\n                availableCapacity={props.availableCapacity}\n                onOpen={(open, actionId) => {\n                  setOpenActionId(open ? actionId : undefined);\n                }}\n                openGameActionId={openActionId}\n                onSelect={(selected, actionId) =>\n                  props.dispatch(\n                    selected\n                      ? {\n                          type: 'SELECT_GAME_ACTION',\n                          payload: actionId,\n                        }\n                      : {\n                          type: 'UNSELECT_GAME_ACTION',\n                          payload: actionId,\n                        },\n                  )\n                }\n                key={round}\n                initialVisible={round === props.currentRound}\n                round={round}\n                actionsWithStatus={props.availableGameActions.filter(\n                  onlyRound(round),\n                )}\n              />\n            );\n          })}\n      </ul>\n    </>\n  );\n}\n","import React from 'react';\nimport cx from 'classnames';\nimport { AppState, BaseEffect } from '../state';\nimport EffectValue, { Sign } from './EffectValue';\nimport styles from './Status.module.css';\nimport { START_CAPACITY } from '../constants';\n\ntype Props = AppState['currentRound'];\n\nexport function ActiveEffects(props: {\n  effects: AppState['currentRound']['activeEffects'];\n  types?: (keyof BaseEffect)[];\n  showUnit: boolean;\n}) {\n  return (\n    <>\n      {(\n        props.types || ['capacityChange', 'userStoryChange', 'gremlinChange']\n      ).map((type) =>\n        props.effects\n          .filter((effect) => effect[type] !== undefined)\n          .map((effect) => {\n            const value = effect[type]!;\n\n            return (\n              <li\n                key={effect.title}\n                className={cx(value < 0 && styles.negative)}\n              >\n                <span\n                  className={cx(\n                    !props.showUnit && styles.cap,\n                    value < 0 && styles.negativeValue,\n                  )}\n                >\n                  {props.showUnit ? (\n                    <EffectValue effect={effect} />\n                  ) : (\n                    <Sign value={value} />\n                  )}\n                </span>\n                {props.showUnit ? <br /> : ' '}\n                {effect.title}\n              </li>\n            );\n          }),\n      )}\n    </>\n  );\n}\n\nexport default function Status(props: Props) {\n  const percentOnUserStories = props.capacity.available / props.capacity.total;\n  const userStoryStatus =\n    percentOnUserStories < 0.5\n      ? 'CRITICAL'\n      : percentOnUserStories < 0.7\n      ? 'WARNING'\n      : 'OK';\n\n  const capacityEffects = props.activeEffects.filter(\n    (effect) => effect.capacityChange !== undefined,\n  );\n\n  return (\n    <>\n      <h2>Working Capacity Breakdown</h2>\n      <ul className={styles.status}>\n        <li>\n          <span className={styles.cap}>{START_CAPACITY}</span> Start Capacity\n        </li>\n        {capacityEffects.length ? (\n          <>\n            <li className={styles.title}>Active Effects</li>\n            <ActiveEffects\n              effects={capacityEffects}\n              types={['capacityChange']}\n              showUnit={false}\n            />\n          </>\n        ) : null}\n        <li className={styles.capThisRound}>\n          <span className={styles.cap}>\n            <span className={styles.sign}>=</span> {props.capacity.total}\n          </span>{' '}\n          Capacity available this round\n        </li>\n        {props.selectedGameActions.length !== 0 && (\n          <>\n            <li className={styles.title}>Selected Actions</li>\n            {props.selectedGameActions.map((gameAction) => (\n              <li key={gameAction.id}>\n                <span className={styles.cap}>\n                  <span className={styles.sign}>-</span> {gameAction.cost}\n                </span>\n                {gameAction.name}\n              </li>\n            ))}\n          </>\n        )}\n\n        <li className={styles.title}>User Stories</li>\n        <li\n          className={cx(\n            userStoryStatus === 'WARNING' && styles.userStoryWarning,\n            userStoryStatus === 'CRITICAL' && styles.userStoryCritical,\n          )}\n        >\n          <span className={styles.cap}>\n            <span className={styles.sign}>-</span> {props.capacity.available}\n          </span>{' '}\n          spent on User Stories\n        </li>\n        <li className={styles.title}>\n          {userStoryStatus === 'WARNING' && (\n            <>: \"feature work needs more priority\"</>\n          )}\n          {userStoryStatus === 'CRITICAL' && (\n            <>: \"not enough time spent on feature work\"</>\n          )}\n        </li>\n      </ul>\n    </>\n  );\n}\n","import React, { ReactNode } from 'react';\nimport styles from './Header.module.css';\n\ntype Props = {\n  children?: ReactNode;\n};\nexport default function Header(props: Props) {\n  return (\n    <div className={styles.header}>\n      <h1>High-Performance Team Game </h1>\n      {props.children}\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default function Rules() {\n  return (\n    <>\n      <h2>Welcome</h2>\n      <p>\n        Reading about improvements rarely sparks the deeper changes teams need\n        to be effective. This game exists for you to start to see the choices a\n        team has to improve.\n      </p>\n      <p>\n        In the longer term is here to spark a discussion among your real team\n        aboutimprovements they can make. To that end, the game is best played\n        in a single web browser where everyone can see what is happening and\n        discuss the options.\n      </p>\n      <h3>Background</h3>\n      <p>\n        Your team is working on the Worlds Smallest Online Bookstore, a site\n        that provides the best results (just a few) for every search, not every\n        result on earth. Were a vulture capital funded company, so if we dont\n        deliver, our funding will be cut. My goal is to help you see the effects\n        of choices/tradeoffs on productivity and team cohesion. While some of\n        the benefits of Agile happen at the individual level, there are many\n        things that affect the relationships between team members and,\n        therefore, the overall cohesion and productivity of the team. The game\n        simulates a year in the life of a team. Each round represents 6 weeks of\n        work.\n      </p>\n      <h2>Rules</h2>\n      <ul>\n        <li>The game lasts 10 rounds.</li>\n        <li>Your team starts with a working capacity of 10 points.</li>\n        <ul>\n          <li>\n            These points can be spent on delivering Features to your customers\n            or Improvements (aka Actions). Each improvement you select costs the\n            team Capacity in this round. They provide a benefit in future\n            rounds.\n          </li>\n        </ul>\n        <li>\n          Improvements fall into three categories:\n          <ul>Engineering Practices - improve the quality of your code</ul>\n          <ul>\n            Communication Practices - improve the team members ability to work\n            together\n          </ul>\n          <ul>\n            Product Ownership Practices - make it more likely that the team will\n            build the right product\n          </ul>\n        </li>\n        <li>\n          Teams that fail to improve all of these categories will eventually be\n          penalized.\n        </li>\n        <li>\n          Features - Just like real life, it is not certain the features you\n          deliver will be valuable to the customer. At the start of the game\n          there is only 30% chance that features committed will delight the\n          customer. If your team invests in Product Ownership improvements, that\n          chance will go up.\n        </li>\n        <li>\n          In addition the game has gremlins, challenges that crop up that effect\n          affect your teams ability to deliver. Examples: Another team borrows\n          your best tester; Management yells at a team member.{' '}\n          <em>\n            Some actions insulate your team against the effects of these\n            problems\n          </em>\n        </li>\n        <li>\n          If you play well, your team's working capacity will increase round by\n          round. Then you will have more points to invest in features and future\n          improvements.\n        </li>\n      </ul>\n      <h2>Rounds</h2>\n      <p>Each round consists of a series of steps:</p>\n      <ol>\n        <li>\n          You get a round description.<br></br>\n          &nbsp;&nbsp;&nbsp;<b>Click Start Round</b>\n        </li>\n        <li>\n          Select Improvements or Actions that will affect the team. Once\n          selected, the cot of the Actions cost will be deducted from the team's\n          Capacity.\n          <br></br>\n          &nbsp;&nbsp;&nbsp;<b>Click Complete Round</b>\n        </li>\n        <li>\n          The game tells you how much capacity there is to spend on User\n          Stories.<br></br>\n          &nbsp;&nbsp;&nbsp;<b>Click Roll for User Stories</b>\n        </li>\n        <li>\n          The game rolls a die for each User Story to determine how many are\n          actually completed.<br></br>\n          &nbsp;&nbsp;&nbsp;<b>Click Next Round</b>\n        </li>\n        <li>\n          At the end of each round, the game also checks to see if your team was\n          affected by a Gremlin. Example: \"Manager yells at a team member\"\n        </li>\n      </ol>\n      <p>\n        Notice each round that your Capacity increases or decreases depending on\n        the improvements you have made and the gremlins that affect you. After\n        round 1, the game displays the active effects of Improvements that were\n        previously made.\n      </p>\n      <p>\n        <em>\n          Actions not selected in a round are still available for later use. To\n          keep the User Interface tidy, they can be found in the round where\n          they were first available.\n        </em>\n      </p>\n      <p>\n        Hint: play the game as often as you want. So if you want to run\n        experiments to see what happens, go for it.\n      </p>\n      <h2>Limitations</h2>\n      <p>\n        If you play well you could improve your teams effectiveness by four to\n        five times. In reality that would take more than the year implied in the\n        game. In addition in reality many improvements would have an ongoing\n        cost that is longer than the game simulates.\n      </p>\n    </>\n  );\n}\n","import React, { HTMLAttributes } from 'react';\nimport cx from 'classnames';\nimport styles from './Content.module.css';\n\nexport default function Content({\n  className,\n  ...rest\n}: HTMLAttributes<HTMLDivElement>) {\n  return <div className={cx(className, styles.content)} {...rest} />;\n}\n","import React, { HTMLAttributes } from 'react';\nimport cx from 'classnames';\nimport styles from './Container.module.css';\n\ntype Props = HTMLAttributes<HTMLDivElement> & {\n  review: boolean;\n  onClose: () => void;\n};\n\nexport default function Container({\n  className,\n  review,\n  children,\n  onClose,\n  ...rest\n}: Props) {\n  return (\n    <div className={cx(className, review && styles.review)} {...rest}>\n      {review && (\n        <div className={styles.reviewHint}>\n          Review <button onClick={onClose}></button>\n        </div>\n      )}\n      {children}\n    </div>\n  );\n}\n","import { TOTAL_ROUNDS } from '../constants';\nimport React from 'react';\nimport {\n  AppRound,\n  AppState,\n  GameActionAction,\n  findGameActionById,\n} from '../state';\nimport { RoundDescription } from './Round';\nimport { ActionImage } from './Actions';\nimport styles from './Log.module.css';\nimport { FinalResults } from 'components';\nimport { ActiveEffects } from './Status';\n\ntype RoundLogEntry = AppRound & {\n  storiesCompleted?: number;\n  actions: GameActionAction[];\n};\ntype Props = {\n  state: AppState;\n};\nexport default function Log(props: Props) {\n  const rounds = [...props.state.pastRounds, props.state.currentRound];\n  const roundsLog: RoundLogEntry[] = [];\n  let currentRound: RoundLogEntry = { ...rounds[0], actions: [] };\n  roundsLog.push(currentRound);\n  props.state.log.forEach((action) => {\n    if (action.type === 'NEXT_ROUND') {\n      if (roundsLog.length < TOTAL_ROUNDS) {\n        currentRound = { ...rounds[roundsLog.length], actions: [] };\n        roundsLog.push(currentRound);\n      }\n    } else {\n      currentRound.actions.push(action);\n    }\n  });\n\n  return (\n    <>\n      <h2>Game Log</h2>\n      <ol className={styles.roundList}>\n        {roundsLog.map((round) => {\n          return (\n            <li key={round.number}>\n              <h3>Round {round.number}</h3>\n              <ul>\n                <li>Total Capacity: {round.capacity.total}</li>\n                <li>User Stories Attempted: {round.capacity.available}</li>\n                <li>\n                  Chance of completing User Stories: {round.userStoryChance}\n                </li>\n                {round.storiesCompleted !== undefined && (\n                  <li>User Stories Completed: {round.storiesCompleted}</li>\n                )}\n              </ul>\n              <RoundDescription gremlin={round.gremlin}>\n                {round.description}\n              </RoundDescription>\n              {round.activeEffects.length ? (\n                <>\n                  <h4>Active Effects</h4>\n                  <ul>\n                    <ActiveEffects effects={round.activeEffects} showUnit />\n                  </ul>\n                </>\n              ) : null}\n              {round.actions.length ? (\n                <>\n                  <h4>Actions Taken</h4>\n                  <ul className={styles.actionList}>\n                    {round.actions.map((action, i) => {\n                      const gameAction = findGameActionById(action.payload);\n                      const isReSelect = round.actions\n                        .slice(0, i)\n                        .map((action) => action.payload)\n                        .includes(action.payload);\n\n                      if (isReSelect) {\n                        return (\n                          <li key={i}>\n                            {action.type === 'UNSELECT_GAME_ACTION' && (\n                              <>\n                                Un-Selected: <del>{gameAction.name}</del>\n                              </>\n                            )}\n                            {action.type === 'SELECT_GAME_ACTION' && (\n                              <>\n                                Re-Selected: <ins>{gameAction.name}</ins>\n                              </>\n                            )}\n                          </li>\n                        );\n                      }\n\n                      return (\n                        <li key={i}>\n                          <ActionImage\n                            gameAction={gameAction}\n                            className={styles.actionImage}\n                          />\n                          <h5>\n                            Selected: (Cost: {gameAction.cost}){' '}\n                            {gameAction.name}\n                          </h5>\n                          {gameAction.description}\n                        </li>\n                      );\n                    })}\n                  </ul>\n                </>\n              ) : null}\n            </li>\n          );\n        })}\n      </ol>\n      <FinalResults state={props.state} />\n    </>\n  );\n}\n","import React, { ButtonHTMLAttributes, ReactNode } from 'react';\nimport cx from 'classnames';\nimport styles from './Tabs.module.css';\n\ntype Props = ButtonHTMLAttributes<HTMLButtonElement> & {\n  active?: boolean;\n};\n\nexport function Tabs(props: { children?: ReactNode }) {\n  return <div className={styles.tabs}>{props.children}</div>;\n}\n\nexport function Tab({ active, className, ...rest }: Props) {\n  return (\n    <button\n      className={cx(styles.tab, className, active && styles.tabActive)}\n      {...rest}\n    />\n  );\n}\n","import React, { HTMLAttributes } from 'react';\nimport cx from 'classnames';\nimport styles from './Rows.module.css';\n\nexport function Rows({ className, ...rest }: HTMLAttributes<HTMLDivElement>) {\n  return <div className={cx(className, styles.rows)} {...rest} />;\n}\n\nexport function Row({ className, ...rest }: HTMLAttributes<HTMLDivElement>) {\n  return <div className={cx(className, styles.row)} {...rest} />;\n}\n","import React, { useState } from 'react';\nimport { useAppState, GameState, INITIAL_STATE } from './state';\nimport { TOTAL_ROUNDS } from './constants';\nimport {\n  Results,\n  FinalResults,\n  Actions,\n  Round,\n  Status,\n  Header,\n  Rules,\n  Tabs,\n  Tab,\n  Content,\n  Button,\n  Welcome,\n  Rows,\n  Container,\n  Row,\n  Log,\n} from './components';\nimport {\n  GAME_STATE_OK,\n  InitialStateWithStatus,\n  restartGame,\n  useVersion,\n  saveToLocalStorage,\n} from './lib';\n\ntype Props = { initialState: GameState };\nexport function App(props: Props) {\n  const [state, dispatch, closeRound, rollGremlin] = useAppState(\n    props.initialState,\n  );\n  const [tab, setTab] = useState<'play' | 'rules' | 'log'>(\n    props.initialState === INITIAL_STATE ? 'rules' : 'play',\n  );\n\n  return (\n    <Container\n      review={state.ui.review !== false}\n      onClose={() => dispatch({ type: 'SET_UI_REVIEW_ACTION', payload: false })}\n    >\n      <Header>\n        <Tabs>\n          <Tab\n            active={false}\n            onClick={restartGame(dispatch)}\n            style={{ maxWidth: '2rem' }}\n            title=\"Restart Game\"\n          >\n            \n          </Tab>\n          <Tab active={tab === 'play'} onClick={() => setTab('play')}>\n            Play\n          </Tab>\n          <Tab active={tab === 'rules'} onClick={() => setTab('rules')}>\n            Rules\n          </Tab>\n          <Tab active={tab === 'log'} onClick={() => setTab('log')}>\n            Log\n          </Tab>\n        </Tabs>\n      </Header>\n      <Content>\n        <div style={{ display: tab === 'play' ? 'block' : 'none' }}>\n          {state.ui.review === false &&\n          state.currentRound.number > TOTAL_ROUNDS ? (\n            <FinalResults state={state} dispatch={dispatch} />\n          ) : (\n            <Round\n              ui={state.ui}\n              key={state.currentRound.number}\n              currentRound={state.currentRound}\n              welcome={\n                <Welcome\n                  review={state.ui.review}\n                  dispatch={dispatch}\n                  gremlin={state.currentRound.gremlin}\n                >\n                  {state.currentRound.description}\n                </Welcome>\n              }\n              actions={\n                <>\n                  <Button\n                    onClick={() =>\n                      dispatch({\n                        type: 'SET_UI_VIEW_ACTION',\n                        payload: 'welcome',\n                      })\n                    }\n                  >\n                     Back\n                  </Button>\n                  <Button\n                    primary\n                    onClick={() =>\n                      dispatch({\n                        type: 'SET_UI_VIEW_ACTION',\n                        payload: 'results',\n                      })\n                    }\n                  >\n                    {state.ui.review === false\n                      ? 'Complete Round'\n                      : 'Show User Stories'}\n                  </Button>\n                  {state.currentRound.gremlin && (\n                    <p>\n                       Gremlin just happened:&nbsp;\n                      <strong>{state.currentRound.gremlin.name}</strong>\n                    </p>\n                  )}\n                  <Rows>\n                    <Row>\n                      <Actions\n                        ui={state.ui}\n                        currentRound={state.currentRound.number}\n                        availableCapacity={\n                          state.currentRound.capacity.available\n                        }\n                        availableGameActions={state.availableGameActions}\n                        dispatch={dispatch}\n                      />\n                    </Row>\n                    <Row>\n                      <Status {...state.currentRound} />\n                    </Row>\n                  </Rows>\n                </>\n              }\n              results={\n                <Results\n                  ui={state.ui}\n                  pastRounds={state.pastRounds}\n                  currentRound={state.currentRound}\n                  dispatch={dispatch}\n                  closeRound={closeRound}\n                  rollGremlin={rollGremlin}\n                />\n              }\n            />\n          )}\n        </div>\n        {tab === 'rules' && <Rules />}\n        {tab === 'log' && <Log state={state} />}\n      </Content>\n    </Container>\n  );\n}\n\nexport default function OutdatedStateWarning(props: {\n  initialState: InitialStateWithStatus;\n}) {\n  const version = useVersion();\n  const [initialState, setInitialState] = useState(props.initialState);\n  if (!version) {\n    return null;\n  }\n\n  if (initialState.restored) {\n    return (\n      <>\n        <Header>\n          <br />\n        </Header>\n        <Content style={{ textAlign: 'center' }}>\n          <br />\n          <h2>Do you want to load the game encoded in the link?</h2>\n          <p>This will overwrite any currently running game</p>\n          {initialState.status !== GAME_STATE_OK ? (\n            <p>\n               The saved game to be restored might not work as expected\n              because the game has been updated since then\n            </p>\n          ) : null}\n          <Button\n            onClick={() => {\n              window.location.href = window.location.href.split('?')[0];\n            }}\n          >\n            Continue to my previous game\n          </Button>\n          <Button\n            onClick={() => {\n              saveToLocalStorage(initialState.state, version);\n              window.location.href = window.location.href.split('?')[0];\n            }}\n            primary\n          >\n            Restore Game from {initialState.restored.toLocaleString()}\n          </Button>\n        </Content>\n      </>\n    );\n  }\n\n  if (initialState.status === GAME_STATE_OK) {\n    return <App initialState={initialState.state} />;\n  }\n\n  return (\n    <>\n      <Header>\n        <br />\n      </Header>\n      <Content style={{ textAlign: 'center' }}>\n        <br />\n        <h2>The game has been updated.</h2>\n        <h4>Your currently saved game might not work as expected</h4>\n        <Button\n          onClick={() =>\n            setInitialState({\n              state: initialState.state,\n              status: GAME_STATE_OK,\n            })\n          }\n        >\n          Continue anyways\n        </Button>\n        <Button\n          onClick={() =>\n            setInitialState({ state: INITIAL_STATE, status: GAME_STATE_OK })\n          }\n          primary\n        >\n          Restart Game\n        </Button>\n      </Content>\n    </>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './global.css';\nimport App from './App';\nimport { getInitialState } from './lib';\n\ngetInitialState().then((initialState) => {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App initialState={initialState} />\n    </React.StrictMode>,\n    document.getElementById('root'),\n  );\n});\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"actionList\":\"Log_actionList__14U9B\",\"actionImage\":\"Log_actionImage__14QTL\",\"roundList\":\"Log_roundList__15EiA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tabs\":\"Tabs_tabs__33r_k\",\"tab\":\"Tabs_tab__1XZ6E\",\"tabActive\":\"Tabs_tabActive__s9p5d\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__2Ce79\",\"primary\":\"Button_primary__10Br9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"review\":\"Container_review__pTzdo\",\"reviewHint\":\"Container_reviewHint__3-chd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rows\":\"Rows_rows__1Jspy\",\"row\":\"Rows_row__2ql-8\"};"],"sourceRoot":""}